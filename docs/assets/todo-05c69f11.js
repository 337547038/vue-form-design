import{d as V,L as U,l as n,r as s,B as $,o as b,b as D,w as a,g as t,i as e,m as d,s as R,c as T,q as j,x as A,D as I,t as E,f as G}from"./index-62047d8c.js";const H={class:"flow-detail-drawer"},J={class:"header"},K=t("div",{class:"face"},[t("i",{class:"icon-user"})],-1),M=t("div",{class:"name"},"张三总",-1),P={class:"button"},Q={class:"form-info"},W=t("div",{class:"flow-list"},null,-1),X=t("div",{class:"status"},[t("ul",null,[t("li",{class:"s1"},"● 已完成"),t("li",{class:"s2"},"● 进行中"),t("li",{class:"s3"},"● 未进行"),t("li",{class:"s4"},"● 已拒绝"),t("li",{class:"s5"},"● 跳过")])],-1),Y=V({__name:"drawerCom",setup(B,{expose:g}){const l=U({visible:!1,formId:"",id:"",loading:!0}),v=o=>{l.visible=!0,l.id=o.formId,j(()=>{h(o)})},f=n(),_=n(),u=n({list:[],form:{}}),x=o=>(o.formId=l.formId,o.id=l.id,o),y=()=>{},h=o=>{const i={id:o.flowId};A("flowById",i).then(k=>{const{flow:m,form:c}=k.data;f.value.setValue(I(m.data)),u.value=I(c.data),l.loading=!1,l.formId=c.id,_.value.getData({formId:c.id,id:l.id})})},p=n(),r=n({list:[{type:"divider",control:{},config:{},formItem:{label:"审批意见"}},{type:"select",control:{modelValue:"",appendToBody:!0,placeholder:"请选择常用审批意见"},options:[{label:"同意",value:1},{label:"不同意",value:2}],config:{optionsType:0,span:8},name:"type",formItem:{label:"快选审批意见"}},{type:"textarea",control:{modelValue:""},config:{},name:"remark",formItem:{label:"审批意见",rules:[{required:!0,message:"请输入审批意见",trigger:"change"}]}}],form:{size:"default"},config:{}}),C=({key:o,value:i})=>{o==="type"&&p.value.setValue({remark:i===1?"同意":"不同意"})},q=n({columns:[{label:"节点名称",prop:"nodeName"},{label:"处理人",prop:"name"},{label:"任务状态",prop:"status",config:{}},{label:"开始时间",prop:"startTime",config:{formatter:"{y}-{m}-{d} {h}:{i}:{s}"}},{label:"结束时间",prop:"endTime",config:{formatter:"{y}-{m}-{d} {h}:{i}:{s}"}},{label:"审批意见",prop:"remark"}],config:{columnsSetting:!1}});return g({open:v}),(o,i)=>{const k=s("el-tag"),m=s("el-button"),c=s("ak-form"),w=s("el-tab-pane"),L=s("ak-flow"),N=s("ak-list"),O=s("el-tabs"),S=s("el-drawer"),z=$("loading");return b(),D(S,{modelValue:l.visible,"onUpdate:modelValue":i[0]||(i[0]=F=>l.visible=F),"destroy-on-close":"","with-header":!1,size:"1200px"},{default:a(()=>[t("div",H,[t("div",J,[K,t("div",null,[M,e(k,null,{default:a(()=>[d("总裁助理审批中")]),_:1})]),t("div",P,[e(m,{type:"success"},{default:a(()=>[d("同意")]),_:1}),e(m,{type:"danger"},{default:a(()=>[d("拒绝")]),_:1}),e(m,{type:"primary"},{default:a(()=>[d("流转")]),_:1})])]),e(O,null,{default:a(()=>[e(w,{label:"表单信息"},{default:a(()=>[R((b(),T("div",Q,[e(c,{ref_key:"formEl",ref:_,data:u.value,"before-submit":x,"after-submit":y,type:2,"request-url":"getFormContent","edit-url":"editFormContent"},null,8,["data"]),e(c,{ref_key:"formOptionsEl",ref:p,data:r.value,type:1,onChange:C},null,8,["data"]),W])),[[z,l.loading]])]),_:1}),e(w,{label:"流程图",name:"flow",class:"flow-box"},{default:a(()=>[X,e(L,{type:1,ref_key:"flowEl",ref:f},null,512)]),_:1}),e(w,{label:"流转记录"},{default:a(()=>[e(N,{ref:"tableListEl",data:q.value},null,8,["data"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])}}});const ee=V({__name:"todo",setup(B){const g=n(),l=n({list:[{type:"input",control:{modelValue:"",placeholder:"请输入审批标题"},config:{},name:"title",formItem:{label:"审批标题"}}],form:{size:"default"},config:{submitCancel:!0}}),v=n({columns:[{prop:"title",label:"审批标题"},{prop:"creatTime",label:"发起时间",config:{formatter:"{y}-{m}-{d} {h}:{i}:{s}"}},{prop:"a",label:"流程节点"},{prop:"status",label:"流程状态"}],config:{requestUrl:"flowList",expand:!0}}),f=n(),_=u=>{f.value.open(u)};return(u,x)=>{const y=s("el-tag"),h=s("el-button"),p=s("ak-list");return b(),T("div",null,[e(p,{ref_key:"tableListEl",ref:g,"request-url":"flowList","search-data":l.value,data:v.value},{status:a(({row:r})=>[r.status?(b(),D(y,{key:0},{default:a(()=>[d(E(r.status),1)]),_:2},1024)):G("",!0)]),title:a(({row:r})=>[e(h,{link:"",type:"primary",onClick:C=>_(r)},{default:a(()=>[d(E(r.title),1)]),_:2},1032,["onClick"])]),_:1},8,["search-data","data"]),e(Y,{ref_key:"drawerEl",ref:f},null,512)])}}});export{ee as default};
