import{i as h,B as k,r as i,l as T,I as A,j as y,o as C,b as r,c as x,d as q,e as S,g as l,w as c,u as I,ac as N,h as L,a0 as R,s as j,H as U,E as M}from"./index.67521be0.js";const z={class:"design-flow-container"},H={class:"tools"},O=L("\u4FDD\u5B58"),$=h({__name:"index",setup(P){k().changeBreadcrumb([{label:"\u7CFB\u7EDF\u5DE5\u5177"},{label:"\u6D41\u7A0B\u8BBE\u8BA1"}]);const f=i(),s=i(),d=T(),m=A(),n=i(d.query.tabs||"info"),g=i({list:[{type:"input",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u540D\u79F0"},config:{},name:"name",item:{label:"\u6D41\u7A0B\u540D\u79F0"},customRules:[{type:"required",message:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u540D\u79F0",trigger:"blur"}]},{type:"select",control:{modelValue:"",appendToBody:!0},options:[],config:{optionsType:1,optionsFun:"designList",method:"post",debug:!0,label:"name",value:"id",beforeRequest:e=>(e.type=1,e)},name:"source",item:{label:"\u6D41\u7A0B\u8868\u5355",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u8868\u5355",trigger:"blur"}]}},{type:"switch",control:{modelValue:1,activeValue:1,inactiveValue:0},options:[],config:{optionsType:2},name:"status",item:{label:"\u72B6\u6001"}},{type:"component",control:{modelValue:"",colorPicker:!0},config:{componentName:"DiyIconfont"},name:"icon",item:{label:"\u6D41\u7A0B\u56FE\u6807"}},{type:"select",control:{modelValue:"",appendToBody:!0},options:[],config:{optionsType:2,optionsFun:"flow"},name:"category",item:{label:"\u6240\u5728\u5206\u7EC4"}},{type:"select",control:{modelValue:"",appendToBody:!0},options:[],config:{optionsType:1,optionsFun:"roleList",label:"name",value:"id"},name:"roleId",item:{label:"\u89D2\u8272\u6743\u9650",showLabel:!1}},{type:"textarea",control:{modelValue:""},config:{span:24},name:"remark",item:{label:"\u5907\u6CE8\u8BF4\u660E",showLabel:!1}}],form:{class:"form-row-2",labelWidth:"110px",size:"default"}}),a=y(()=>d.query.id),_=y(()=>a.value?2:1),B=e=>{e.paneName},v=()=>{f.value.submit()},D=e=>{var t,o,u;return a.value&&(e.id=a.value),e.icon&&(e.icon=(t=e.icon)==null?void 0:t.join(",")),e.type=3,(o=s.value)!=null&&o.getValue&&(e.data=R((u=s.value)==null?void 0:u.getValue())),e},F=e=>(e.icon&&(e.icon=e.icon.split(",")),s.value.setValue(j(e.data)),e),V=(e,t)=>{if(e==="success")if(n.value==="info"){if(n.value="flow",!a.value){const o=t.data.insertId;m.push({path:"/design/flow",query:{id:o,tabs:"flow"}}),U(()=>{p()})}}else m.push({path:"/design/flow/list"});if(e==="validate"&&n.value==="flow"){let o;try{for(const u in t)if(!o){o=t[u][0].message;break}M.error(o)}catch{}}},p=()=>{a.value&&f.value.getData({id:a.value})};return C(()=>{p()}),(e,t)=>{const o=r("el-button"),u=r("ak-form"),b=r("el-tab-pane"),w=r("el-tabs");return x(),q("div",z,[S("div",H,[l(o,{type:"primary",onClick:v},{default:c(()=>[O]),_:1})]),l(w,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=E=>n.value=E),class:"flow-tabs",onTabClick:B},{default:c(()=>[l(b,{label:"\u57FA\u7840\u4FE1\u606F",name:"info",class:"tabs-info"},{default:c(()=>[l(u,{ref_key:"formEl",ref:f,formData:g.value,type:I(_),addUrl:"designSave",editUrl:"designEdit",requestUrl:"designById",beforeSubmit:D,afterSubmit:V,afterResponse:F},null,8,["formData","type"])]),_:1}),l(b,{label:"\u5BA1\u6279\u6D41\u7A0B",name:"flow"},{default:c(()=>[l(N,{ref_key:"flowEl",ref:s},null,512)]),_:1})]),_:1},8,["modelValue"])])}}});export{$ as default};
