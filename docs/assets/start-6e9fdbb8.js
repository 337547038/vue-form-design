import{i as D,y as C,l as x,D as B,r as n,j as E,o as S,b as c,E as T,A as F,c as R,d as U,g as r,w as d,u as V,e as a,v as i,G as v,C as j}from"./index-96eddb90.js";const N={class:"container-apply-start"},A=a("div",{class:"status"},[a("ul",null,[a("li",{class:"s1"},"● 已完成"),a("li",{class:"s2"},"● 进行中"),a("li",{class:"s3"},"● 未进行"),a("li",{class:"s4"},"● 已拒绝"),a("li",{class:"s5"},"● 跳过")])],-1),O=D({__name:"start",setup(G){C().changeBreadcrumb([{label:"工作台"},{label:"发起流程"}]);const t=x(),f=B(),_=n(),m=n(),p=n({list:[],form:{}}),y=n(!0),b=E(()=>t.query.id?2:1),u=n(),g=()=>{const e={id:t.query.flowId};i("designById",e).then(o=>{_.value.setValue(v(o.data.data)),u.value=o.data.source,i("designById",{id:o.data.source}).then(l=>{p.value=v(l.data.data),j(()=>{y.value=!1})});const s=t.query.id;s&&m.value.getData({formId:u.value,id:s})})},h=e=>(e.formId=u.value,t.query.id&&(e.id=t.query.id),e),w=(e,o)=>{if(e==="success"){if(t.query.id){f.push({path:"/task/applyed"});return}const s={userId:0,flowId:t.query.flowId,formId:o.data.insertId,title:"user的请假审批",creatTime:new Date};i("flowSave",s).then(()=>{f.push({path:"/task/applyed"})}).catch(l=>{console.log(l)})}else console.log("提交失败")};return S(()=>{g()}),(e,o)=>{const s=c("ak-form"),l=c("el-tab-pane"),I=c("ak-flow"),k=c("el-tabs"),q=T("loading");return F((R(),U("div",N,[r(k,null,{default:d(()=>[r(l,{label:"表单信息"},{default:d(()=>[r(s,{ref_key:"formEl",ref:m,formData:p.value,beforeSubmit:h,afterSubmit:w,type:V(b),requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent"},null,8,["formData","type"])]),_:1}),r(l,{label:"流程图",name:"flow",class:"flow-box"},{default:d(()=>[A,r(I,{type:1,ref_key:"flowEl",ref:_},null,512)]),_:1})]),_:1})])),[[q,y.value]])}}});export{O as default};
