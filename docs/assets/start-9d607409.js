import{d as D,v as B,u as C,C as x,r as n,a as E,b as S,h as c,D as T,z as F,o as R,c as U,m as r,w as d,l as a,q as i,E as v,B as V}from"./index-3679850f.js";const N={class:"container-apply-start"},j=a("div",{class:"status"},[a("ul",null,[a("li",{class:"s1"},"● 已完成"),a("li",{class:"s2"},"● 进行中"),a("li",{class:"s3"},"● 未进行"),a("li",{class:"s4"},"● 已拒绝"),a("li",{class:"s5"},"● 跳过")])],-1),O=D({__name:"start",setup(z){B().changeBreadcrumb([{label:"工作台"},{label:"发起流程"}]);const t=C(),f=x(),_=n(),m=n(),p=n({list:[],form:{}}),y=n(!0),b=E(()=>t.query.id?2:1),u=n(),h=()=>{const e={id:t.query.flowId};i("designById",e).then(o=>{_.value.setValue(v(o.data.data)),u.value=o.data.source,i("designById",{id:o.data.source}).then(l=>{p.value=v(l.data.data),V(()=>{y.value=!1})});const s=t.query.id;s&&m.value.getData({formId:u.value,id:s})})},g=e=>(e.formId=u.value,t.query.id&&(e.id=t.query.id),e),w=(e,o)=>{if(e==="success"){if(t.query.id){f.push({path:"/task/applyed"});return}const s={userId:0,flowId:t.query.flowId,formId:o.data.insertId,title:"user的请假审批",creatTime:new Date};i("flowSave",s).then(()=>{f.push({path:"/task/applyed"})}).catch(l=>{console.log(l)})}else console.log("提交失败")};return S(()=>{h()}),(e,o)=>{const s=c("ak-form"),l=c("el-tab-pane"),I=c("ak-flow"),k=c("el-tabs"),q=T("loading");return F((R(),U("div",N,[r(k,null,{default:d(()=>[r(l,{label:"表单信息"},{default:d(()=>[r(s,{ref_key:"formEl",ref:m,formData:p.value,beforeSubmit:g,afterSubmit:w,type:b.value,requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent"},null,8,["formData","type"])]),_:1}),r(l,{label:"流程图",name:"flow",class:"flow-box"},{default:d(()=>[j,r(I,{type:1,ref_key:"flowEl",ref:_},null,512)]),_:1})]),_:1})])),[[q,y.value]])}}});export{O as default};
