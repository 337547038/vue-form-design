import{f as g,q as _,C as D,y as p,r as C,B as y,c as v,o as b,a as h,E as B,v as I,b as k,d as E,e as F,u as q,L as i,m as x,G as S,M as j,n as L}from"./index.2b72f3d0.js";const M={style:{"min-height":"300px"}},U=g({__name:"form",setup(R){const d=_(),r=D().query,c=p(),n=C(),e=y({formData:{list:[],form:{},config:{}},dict:{},formId:r.form,id:r.id,loading:!0}),u=v(()=>r.id?2:1),f=()=>{if(!e.formId)return i.error("\u975E\u6CD5\u64CD\u4F5C."),!1;const t={id:e.formId};x("designById",t).then(a=>{var s;const o=a.data;o&&Object.keys(o).length&&(e.formData=S(o.data),e.dict=j(o.dict),(r.id||((s=e.formData.config)==null?void 0:s.addLoad))&&n.value.getData({formId:e.formId,id:r.id}),d.changeBreadcrumb([{label:"\u5185\u5BB9\u7BA1\u7406"},{label:o.name}])),L(()=>{e.loading=!1})}).catch(a=>{e.loading=!1,i.error(a.message||"\u975E\u6CD5\u64CD\u4F5C..")})},m=t=>(t.formId=e.formId,t.id=r.id,t),l=t=>{t==="success"&&c.go(-1)};return b(()=>{f()}),(t,a)=>{const o=h("ak-form"),s=B("loading");return I((k(),E("div",M,[F(o,{ref_key:"formEl",ref:n,formData:e.formData,type:q(u),dict:e.dict,requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent",beforeSubmit:m,afterSubmit:l},null,8,["formData","type","dict"])])),[[s,e.loading]])}}});export{U as default};
