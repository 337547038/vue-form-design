import{i as B,B as I,l as k,I as E,r as l,j as q,o as x,b as r,O as S,D as A,c as T,d as R,g as n,w as d,u as U,e as a,m as i,s as y,H as V}from"./index.67521be0.js";const j={class:"container-apply-start"},N=a("div",{class:"status"},[a("ul",null,[a("li",{class:"s1"},"\u25CF \u5DF2\u5B8C\u6210"),a("li",{class:"s2"},"\u25CF \u8FDB\u884C\u4E2D"),a("li",{class:"s3"},"\u25CF \u672A\u8FDB\u884C"),a("li",{class:"s4"},"\u25CF \u5DF2\u62D2\u7EDD"),a("li",{class:"s5"},"\u25CF \u8DF3\u8FC7")])],-1),M=B({__name:"start",setup(O){I().changeBreadcrumb([{label:"\u5DE5\u4F5C\u53F0"},{label:"\u53D1\u8D77\u6D41\u7A0B"}]);const t=k(),f=E(),_=l(),m=l(),p=l({list:[],form:{}}),D=l(!0),v=q(()=>t.query.id?2:1),c=l(),F=()=>{const e={id:t.query.flowId};i("designById",e).then(s=>{_.value.setValue(y(s.data.data)),c.value=s.data.source,i("designById",{id:s.data.source}).then(u=>{p.value=y(u.data.data),V(()=>{D.value=!1})});const o=t.query.id;o&&m.value.getData({formId:c.value,id:o})})},C=e=>(e.formId=c.value,t.query.id&&(e.id=t.query.id),e),b=(e,s)=>{if(e==="success"){if(t.query.id){f.push({path:"/task/applyed"});return}const o={userId:0,flowId:t.query.flowId,formId:s.data.insertId,title:"user\u7684\u8BF7\u5047\u5BA1\u6279",creatTime:new Date};i("flowSave",o).then(()=>{f.push({path:"/task/applyed"})}).catch(u=>{console.log(u)})}else console.log("\u63D0\u4EA4\u5931\u8D25")};return x(()=>{F()}),(e,s)=>{const o=r("ak-form"),u=r("el-tab-pane"),g=r("ak-flow"),h=r("el-tabs"),w=S("loading");return A((T(),R("div",j,[n(h,null,{default:d(()=>[n(u,{label:"\u8868\u5355\u4FE1\u606F"},{default:d(()=>[n(o,{ref_key:"formEl",ref:m,formData:p.value,beforeSubmit:C,afterSubmit:b,type:U(v),requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent"},null,8,["formData","type"])]),_:1}),n(u,{label:"\u6D41\u7A0B\u56FE",name:"flow",class:"flow-box"},{default:d(()=>[N,n(g,{type:1,ref_key:"flowEl",ref:_},null,512)]),_:1})]),_:1})])),[[w,D.value]])}}});export{M as default};
