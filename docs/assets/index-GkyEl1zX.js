import{d as k,l as t,G as N,p as E,r as L,o as x,c as S,i as V,g as h,x as q,N as w,k as B,u as M,A as T,J as F,q as U,I as $,y,ai as j,aj as z,E as I}from"./index--gPzAhw2.js";const A=["src"],D=k({__name:"code",props:{placeholder:{}},emits:["update:modelValue","focus"],setup(r,{emit:_}){const m=_,o=t(""),c=t(),n=t("");N(()=>o.value,()=>{m("update:modelValue",o.value)});const u=()=>{m("focus",n.value,l)},l=()=>{q("getCaptcha",{}).then(d=>{const{base64:s,codeId:i}=d.data;c.value="data:image/png;base64,"+s,n.value=i}).catch(()=>{})};return E(()=>{l()}),(d,s)=>{const i=L("el-input");return x(),S("div",null,[V(i,{placeholder:d.placeholder,modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e),onFocus:u},null,8,["placeholder","modelValue"]),h("img",{src:c.value,class:"img",alt:"",onClick:l},null,8,A)])}}}),G=w(D,[["__scopeId","data-v-9f6e29df"]]),J=r=>(j("data-v-455d91fd"),r=r(),z(),r),K={class:"login"},P={class:"main"},H=J(()=>h("h3",null,"后台管理系统",-1)),C=k({__name:"index",setup(r){const _=t(),m=B(),o=M(),c=T(),n=t(),u=t(),l=t({list:[{type:"input",control:{prefixIcon:"User",modelValue:"admin",placeholder:"请输入登录账号"},config:{},name:"userName",formItem:{label:"用户名",hideLabel:!0},customRules:[{type:"required",message:"请输入登录账号",trigger:"blur"}]},{type:"password",control:{prefixIcon:"Lock",modelValue:"123456",placeholder:"请输入密码"},config:{},name:"password",formItem:{label:"密码",hideLabel:!0},customRules:[{type:"required",message:"请输入密码",trigger:"blur"}]},{type:"component",control:{modelValue:"",placeholder:"请输入验证码",onFocus:(e,a)=>{n.value=e,u.value=a}},config:{componentName:F(G)},name:"code",formItem:{label:"验证码",hideLabel:!0},customRules:[{type:"required",message:"请输入验证码",trigger:"blur"}]},{type:"button",control:{label:"登录",type:"primary",key:"submit"}}],form:{size:"default"},config:{}}),d=e=>(e.codeId=n.value,e),s=(e,a)=>{e==="success"?(m.setLoginInfo(a,!0),i().then(()=>{const p=c.query.redirect?c.query.redirect:"/";U(()=>{o.push({path:p})})})):u.value&&u.value()},i=()=>new Promise(e=>{q("userMenuList",{query:{status:1,navShow:1},extend:{sort:"sort asc"}}).then(a=>{var b;const p=((b=a.data)==null?void 0:b.list)||[],g=[],v=[];p.forEach(f=>{f.path&&g.push(f.path),f.type!==2&&v.push(f)});const R=$(v);y("formMenuList",R,0),y("resources",g,0),e({})})});return(e,a)=>{const p=L("ak-form");return x(),S("div",K,[h("div",P,[H,V(p,{ref_key:"formEl",ref:_,"after-submit":s,data:l.value,"submit-url":"loginSubmit","before-submit":d},null,8,["data"])])])}}});typeof I=="function"&&I(C);const Q=w(C,[["__scopeId","data-v-455d91fd"]]);export{Q as default};
