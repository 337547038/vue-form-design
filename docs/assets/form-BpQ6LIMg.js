import{d as D,k,y as q,u as U,l as C,G as I,h as s,p as j,r as B,W as E,s as F,o as x,c as O,j as R,N as f,A as M,X as m,z as d}from"./index-BMqeUH7Y.js";const N={style:{"min-height":"300px"}},S=D({__name:"form",setup(T){const g=k(),l=q(),v=U(),i=C(),r=I({formData:{list:[],form:{},config:{}},dict:{},loading:!0}),u=s(()=>l.query.id),o=s(()=>l.query.form),c=s(()=>u.value?"edit":"add"),p=s(()=>{const{submitUrl:e}=r.formData.config;return e||(c.value==="add"?"saveFormContent":"editFormContent")}),_=s(()=>{const{requestUrl:e}=r.formData.config;return e||"getFormContent"}),b=()=>{if(!o.value)return f.error("非法操作."),!1;const e={id:o.value};M("designById",e).then(a=>{const t=a.data;if(t&&Object.keys(t).length){const n=m(t.data);n&&Object.keys(n).length&&(r.formData=m(t.data)),u.value&&i.value.getData({formId:o.value,id:u.value}),g.changeBreadcrumb([{label:"内容管理"},{label:t.name}])}r.loading=!1}).catch(a=>{r.loading=!1,f.error(a.message||"非法操作..")})},y=e=>(e.formId=o.value,e),h=(e,a,t)=>{a&&t==="submit"&&v.go(-1)};return j(()=>{b()}),(e,a)=>{const t=B("ak-form"),n=E("loading");return F((x(),O("div",N,[R(t,{ref_key:"formEl",ref:i,data:r.formData,"operate-type":c.value,"request-url":_.value,"submit-url":p.value,before:y,params:{formId:o.value.value},after:h},null,8,["data","operate-type","request-url","submit-url","params"])])),[[n,r.loading]])}}});typeof d=="function"&&d(S);export{S as default};
