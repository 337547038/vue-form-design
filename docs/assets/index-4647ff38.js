import{d as _,l as a,G as I,H as B,p as T,r as u,o as h,b as L,x as D,I as R,k as E,J as q,L as w,c as z,i as y,w as K,q as k}from"./index-62047d8c.js";const S=_({__name:"content",props:{modelValue:{}},emits:["update:modelValue"],setup(b,{emit:m}){const l=b,o=a(),i=a([]),p={children:"children",label:"name"},r=()=>{const s=o.value.getCheckedKeys(!1);m("update:modelValue",s.join(","))},t=()=>{D("menuList",{status:1}).then(s=>{i.value=R(s.data.list)})},f=I(()=>l.modelValue,()=>{l.modelValue&&o.value.setCheckedKeys(l.modelValue.split(","),!1)});return B(()=>{f()}),T(()=>{t()}),(s,g)=>{const c=u("el-tree");return h(),L(c,{ref_key:"treeRef",ref:o,data:i.value,"show-checkbox":"","node-key":"id","highlight-current":"",props:p,onCheckChange:r},null,8,["data"])}}}),N=_({__name:"index",setup(b){const m=E(),l=a(),o=a(),i=a({list:[{type:"input",control:{modelValue:"",placeholder:"请输入角色名称"},config:{},name:"name",formItem:{label:"角色名称"}},{type:"select",control:{modelValue:"",appendToBody:!0},options:[],config:{optionsType:2,addAll:"全部",optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}}],form:{size:"default"},config:{submitCancel:!0}}),p=a({columns:[{label:"多选",type:"selection"},{label:"序号",type:"index",width:"70px"},{label:"角色名称",prop:"name"},{label:"状态",prop:"status",config:{dictKey:"sys-status",tagList:{1:"success",0:"info"}}},{label:"操作",prop:"__control"}],config:{expand:!0,openType:"dialog"},operateBtn:[{label:"分配用户",click:e=>{m.push({path:"/system/user",query:{role:e.id}})}},{label:"编辑",key:"edit",click:e=>{k(()=>{console.log(e)})}},{label:"删除",key:"del"}],controlBtn:[{label:"新增",key:"add",type:"primary",size:"small",icon:"plus"},{label:"批量删除",key:"del",type:"danger",size:"small",icon:"delete"}]}),r=a({list:[{type:"input",control:{modelValue:""},config:{},name:"name",formItem:{label:"角色名称"},customRules:[{type:"required",message:"角色名称不能为空",trigger:"blur"}]},{type:"radio",control:{modelValue:1},options:[],config:{optionsType:2,optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}},{type:"component",control:{modelValue:""},config:{componentName:q(S)},name:"menuId",formItem:{label:"菜单权限"}},{type:"textarea",control:{modelValue:""},config:{},name:"remark",formItem:{label:"备注"}}],form:{labelWidth:80,size:"default"},config:{submitCancel:!0}}),t=w({visible:!1,title:"",formType:1,dict:{},editId:""}),f=(e,n)=>{var d;(e.key==="add"||e.key==="edit")&&(t.visible=!0,t.title=e.key==="add"?"新增":"编辑",t.formType=e.key==="add"?1:2,t.editId=n&&n.id,e.key==="add"&&((d=r.value.config)!=null&&d.addLoad)&&k(()=>{l.value.getData()}),e.key==="edit"&&k(()=>{l.value.setValue(n)}))},s=e=>(t.formType===2&&(e.id=t.editId),e),g=e=>{e==="success"&&(c(),o.value.getListData())},c=()=>{t.visible=!1,t.editId=""},v=e=>{e==="reset"&&c()};return(e,n)=>{const d=u("ak-list"),V=u("ak-form"),C=u("el-dialog");return h(),z("div",null,[y(d,{ref_key:"tableListEl",ref:o,"request-url":"roleList","delete-url":"roleDelete","search-data":i.value,data:p.value,onBtnClick:f},null,8,["search-data","data"]),y(C,{"destroy-on-close":"",modelValue:t.visible,"onUpdate:modelValue":n[0]||(n[0]=x=>t.visible=x),title:t.title,width:"420px"},{default:K(()=>[y(V,{ref_key:"formEl",ref:l,data:r.value,dict:t.dict,type:t.formType,"submit-url":"roleSave","edit-url":"roleEdit","before-submit":s,"after-submit":g,onBtnClick:v},null,8,["data","dict","type"])]),_:1},8,["modelValue","title"])])}}});export{N as default};
