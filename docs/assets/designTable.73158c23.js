var A=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var z=(a,n,i)=>n in a?A(a,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[n]=i,G=(a,n)=>{for(var i in n||(n={}))Z.call(n,i)&&z(a,i,n[i]);if(q)for(var i of q(n))K.call(n,i)&&z(a,i,n[i]);return a},S=(a,n)=>J(a,Q(n));import{h as W,v as X,a as Y}from"./vueFile.d738ec56.js";import{_ as $,b as ee,s as oe}from"./index.2eb78c65.js";import{S as ae,Z as le,i as te,p as ne,k as se,P as B,Q as re,q as ce,r,U as ie,I as de,o as d,y as b,h as p,F as g,a as c,w as s,A as j,z as U,E as k,B as y,c as D,s as pe,v as x,x as ue,M as be,_ as _e}from"./vendor.df12524c.js";import{s as C,l as M,o as N}from"./index.6c162138.js";const fe={name:"list",props:{},components:{headTools:W,vueFile:X},setup(){const a=ae(),{proxy:n}=le(),i=te(),e=ne({filedList:[],otherFiled:[{label:"\u52FE\u9009",prop:"__selection",type:"selection"},{label:"\u5E8F\u53F7",prop:"__index",type:"index"},{label:"\u64CD\u4F5C",prop:"__control"}],checkboxGroup:[],tableData:{config:{},columns:[]},editor:{},visibleDialog:!1,loading:!1,queryId:a.query.id,selectCheck:"",editIndex:"",dataList:[{}]}),O=["txt","title","table","component","upload"],f=o=>{o.list.forEach(l=>{l.type==="grid"||l.type==="tabs"?l.columns.forEach(u=>{f(u)}):l.type==="card"?f(l):O.indexOf(l.type)===-1&&e.filedList.push({prop:l.name,label:l.item.label,help:l.config.help||""})})},m=o=>{switch(o){case"del":e.tableData.columns=[],e.checkboxGroup=[];break;case"json":_(e.tableData);break;case"vue":i.value.openTable(e.tableData);break;case"import":_({});break;case"save":I();break}},v=o=>{e.checkboxGroup.indexOf(o.label)===-1?e.tableData.columns.forEach((u,h)=>{u.label===o.label&&u.prop===o.prop&&e.tableData.columns.splice(h,1)}):e.tableData.columns.push(o)},_=o=>{e.visibleDialog=!0;const l=N(o,!0);B(()=>{e.editor=Y(l)})},V=()=>{try{e.editIndex!==""?(e.tableData.columns[e.editIndex]=C(e.editor.getValue()),e.editIndex=""):e.tableData=C(e.editor.getValue()),e.visibleDialog=!1}catch(o){k.error(o.message)}},I=()=>{if(!e.queryId){M("tableData",e.tableData),k.info("\u6570\u636E\u5DF2\u6682\u5B58\u5728localStorage");return}e.loading=!0;const o={tableData:N(e.tableData),id:e.queryId};oe(o).then(l=>{l.data.code===200?k({message:"\u4FDD\u5B58\u6210\u529F\uFF01",type:"success"}):k.error(l.data.message),e.loading=!1}).catch(l=>{k.error("\u4FDD\u5B58\u5F02\u5E38"),e.loading=!1})},T=o=>{e.editIndex="",o()},F=()=>{_(e.tableData)},E=o=>{let l={};e.tableData.columns.forEach((u,h)=>{u.prop===o&&(l=u,e.editIndex=h)}),_(l)},w=()=>{const o=n.$el.querySelector(".el-table__header-wrapper tr");_e.create(o,{animation:180,delay:0,onEnd:l=>{const u=e.tableData.columns[l.oldIndex];e.tableData.columns.splice(l.oldIndex,1),e.tableData.columns.splice(l.newIndex,0,u)}})};if(e.queryId)ee(e.queryId).then(o=>{o.data.code===200&&(f(C(o.data.data[0].formData)),e.tableData=C(o.data.data[0].tableData),e.tableData.columns.forEach(l=>{e.checkboxGroup.push(l.label)}))});else{const o=M();o&&(o.tableData&&(e.tableData=o.tableData),o.formData&&(console.log(o.formData),f(o.formData)))}return se(()=>{B(()=>{w()})}),re(()=>{Object.keys(e.editor).length!==0&&(e.editor.destroy(),e.editor.container.remove())}),S(G({headToolClick:m,checkChange:v},ce(e)),{dialogConfirm:V,drawerBeforeClose:T,vueFileEl:i,editOtherField:F,selectChange:E})}},me={class:"container design-table"},he={class:"components-list"},ge=p("div",{class:"title"},"\u53EF\u9009\u5B57\u6BB5",-1),ke={class:"content"},De=p("div",{class:"title"},"\u5176\u4ED6\u5B57\u6BB5",-1),ve={class:"content"},ye={class:"title"},Ce=x("\u7F16\u8F91\u81EA\u5B9A\u4E49\u5B57\u6BB5"),xe={class:"main-body"},Ve={class:"main-form main-table"},Ie=p("p",{style:{padding:"10px 0"}},"\u70B9\u51FB\u8868\u5934\u53EF\u62D6\u52A8\u6539\u53D8\u987A\u5E8F",-1),Te=["innerHTML"],Fe=p("i",{class:"icon-help"},null,-1),Ee={key:1},we={key:2},Le={class:"sidebar-tools"},Oe=x(" \u8BF7\u4F7F\u7528\u751F\u6210\u811A\u672C\u9884\u89C8\u529F\u80FD\uFF0C\u7F16\u8F91config\u5C5E\u6027 "),qe={key:0,id:"editJson"},ze={class:"dialog-footer"},Ge=x(" \u786E\u5B9A ");function Se(a,n,i,e,O,f){const m=r("el-checkbox"),v=r("el-checkbox-group"),_=r("el-button"),V=r("headTools"),I=r("el-tooltip"),T=r("el-table-column"),F=r("el-table"),E=r("el-option"),w=r("el-select"),o=r("el-form-item"),l=r("el-tab-pane"),u=r("el-tabs"),h=r("el-form"),P=r("el-drawer"),R=r("vue-File"),H=ie("loading");return de((d(),b("div",me,[p("div",he,[a.filedList&&a.filedList.length>0?(d(),b(g,{key:0},[ge,p("div",ke,[c(v,{modelValue:a.checkboxGroup,"onUpdate:modelValue":n[0]||(n[0]=t=>a.checkboxGroup=t),size:"small"},{default:s(()=>[(d(!0),b(g,null,y(a.filedList,t=>(d(),D(m,{label:t.label,border:!0,key:t.prop,onChange:L=>e.checkChange(t)},null,8,["label","onChange"]))),128))]),_:1},8,["modelValue"])])],64)):j("",!0),De,p("div",ve,[c(v,{modelValue:a.checkboxGroup,"onUpdate:modelValue":n[1]||(n[1]=t=>a.checkboxGroup=t),size:"small"},{default:s(()=>[(d(!0),b(g,null,y(a.otherFiled,t=>(d(),D(m,{label:t.label,border:!0,key:t.prop,onChange:L=>e.checkChange(t)},null,8,["label","onChange"]))),128))]),_:1},8,["modelValue"])]),p("div",ye,[c(_,{size:"small",onClick:e.editOtherField},{default:s(()=>[Ce]),_:1},8,["onClick"])])]),p("div",xe,[c(V,{onClick:e.headToolClick,type:"2"},null,8,["onClick"]),p("div",Ve,[Ie,c(F,U({data:a.dataList},a.tableData.config,{ref:"tableEl"}),{default:s(()=>[(d(!0),b(g,null,y(a.tableData.columns,t=>(d(),D(T,be(U({key:t.prop||t.label},t)),pe({_:2},[t.help?{name:"header",fn:s(L=>[x(ue(L.column.label)+" ",1),c(I,{placement:"top"},{content:s(()=>[p("span",{innerHTML:t.help},null,8,Te)]),default:s(()=>[Fe]),_:2},1024)])}:void 0,t.type!=="index"?{name:"default",fn:s(()=>[t.type==="selection"?(d(),D(m,{key:0})):t.prop==="__control"?(d(),b("span",Ee,"\u5220\u9664")):(d(),b("span",we,"\u6D4B\u8BD5\u6570\u636E"))])}:void 0]),1040))),128))]),_:1},16,["data"])])]),p("div",Le,[c(h,{size:"small"},{default:s(()=>[c(u,{modelValue:"first"},{default:s(()=>[c(l,{label:"\u5B57\u6BB5\u5C5E\u6027",name:"first"},{default:s(()=>[c(o,{label:"\u9009\u62E9\u8868\u5934\u5B57\u6BB5"},{default:s(()=>[c(w,{modelValue:a.selectCheck,"onUpdate:modelValue":n[2]||(n[2]=t=>a.selectCheck=t),onChange:e.selectChange},{default:s(()=>[(d(!0),b(g,null,y(a.tableData.columns,t=>(d(),D(E,{key:t.prop,value:t.prop,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),c(l,{label:"\u8868\u683C\u5C5E\u6027",name:"second"},{default:s(()=>[Oe]),_:1})]),_:1})]),_:1})]),c(P,{modelValue:a.visibleDialog,"onUpdate:modelValue":n[3]||(n[3]=t=>a.visibleDialog=t),size:"60%",direction:"rtl","custom-class":"json-dialog","append-to-body":!0,"before-close":e.drawerBeforeClose},{default:s(()=>[a.visibleDialog?(d(),b("div",qe)):j("",!0),p("div",ze,[c(_,{type:"primary",size:"small",onClick:e.dialogConfirm},{default:s(()=>[Ge]),_:1},8,["onClick"])])]),_:1},8,["modelValue","before-close"]),c(R,{ref:"vueFileEl"},null,512)])),[[H,a.loading]])}var Pe=$(fe,[["render",Se]]);export{Pe as default};
