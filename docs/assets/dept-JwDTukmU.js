import{d as T,l,L as V,r as n,o as x,c as C,i as c,w as E,I as d,q as m}from"./index-DW6ahk2i.js";const D=T({__name:"dept",setup(L){const p=l(),a=l(),u=l([]),f=l({list:[{type:"input",control:{modelValue:"",placeholder:"请输入部门名称"},config:{},name:"name",formItem:{label:"部门名称"}},{type:"select",control:{modelValue:""},options:[],config:{optionsType:2,optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}}],form:{labelWidth:"",class:"",size:"default"},config:{submitCancel:!0}}),b=l({tableProps:{rowKey:"id"},columns:[{label:"部门名称",prop:"name"},{label:"排序",prop:"sort"},{label:"状态",prop:"status",config:{dictKey:"sys-status",tagList:{1:"success",2:"info"}}},{label:"操作",prop:"__control"}],controlBtn:[{label:"新增",type:"primary",size:"small",icon:"plus",click:()=>{e.visible=!0,e.title="新增部门",e.formType=1,i()}}],operateBtn:[{label:"新增",click:t=>{e.visible=!0,e.title="新增部门",e.formType=1,m(()=>{a.value.setValue({parentId:t.id})}),i()}},{label:"编辑",click:t=>{e.visible=!0,e.title="编辑部门",e.formType=2,e.editId=t.id,t.parentId===0&&(t.parentId=""),m(()=>{a.value.setValue(t)}),i()}},{label:"删除",key:"del"}],config:{fixedBottomScroll:!1}}),e=V({visible:!1,title:"",formType:1,editId:""}),y=l({list:[{type:"treeSelect",control:{modelValue:"",data:[],renderAfterExpand:!1,props:{label:"name",value:"id"},checkStrictly:!0,placeholder:"请选择上级部门"},config:{optionsType:0},name:"parentId",formItem:{label:"上级部门"}},{type:"input",control:{modelValue:"",placeholder:"请输入部门名称"},config:{},name:"name",formItem:{label:"部门名称"},customRules:[{type:"required",message:"部门名称不能为空",trigger:"blur"}]},{type:"inputNumber",control:{modelValue:0,controlsPosition:"right"},config:{},name:"sort",formItem:{label:"排序"}},{type:"radio",control:{modelValue:1},options:[],config:{optionsType:2,optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}},{type:"textarea",control:{modelValue:""},config:{},name:"remark",formItem:{label:"备注"}}],form:{labelWidth:"100px",size:"default"},config:{submitCancel:!0}}),v=t=>(e.formType===2&&(t.id=e.editId,delete t.children),t),g=t=>{e.visible=!1,t==="success"&&p.value.getListData()},_=t=>{t==="reset"&&(e.visible=!1)},k=(t,o)=>{const r=o.list,s=d(r);return u.value=s,d(s)},i=()=>{m(()=>{a.value.setOptions({parentId:u.value})})};return(t,o)=>{const r=n("ak-list"),s=n("ak-form"),I=n("el-dialog");return x(),C("div",null,[c(r,{ref_key:"tableListEl",ref:p,"request-url":"deptList","delete-url":"deptDelete","search-data":f.value,data:b.value,"after-fetch":k},null,8,["search-data","data"]),c(I,{modelValue:e.visible,"onUpdate:modelValue":o[0]||(o[0]=h=>e.visible=h),title:e.title,width:"400px","destroy-on-close":""},{default:E(()=>[c(s,{ref_key:"formNameEl",ref:a,type:e.formType,data:y.value,"submit-url":"deptSave","edit-url":"deptEdit","before-submit":v,"after-submit":g,onBtnClick:_},null,8,["type","data"])]),_:1},8,["modelValue","title"])])}}});export{D as default};
