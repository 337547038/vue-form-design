import{i as g,B as _,l as D,I as p,r as C,M as y,j as b,o as h,b as v,O as I,D as B,c as k,d as E,g as F,u as S,E as i,m as j,s as x,S as q,H as M}from"./index.b4d3cd99.js";const O={style:{"min-height":"300px"}},U=g({__name:"form",setup(R){const d=_(),r=D().query,c=p(),n=C(),e=y({formData:{list:[],form:{},config:{}},dict:{},formId:r.form,id:r.id,loading:!0}),u=b(()=>r.id?2:1),f=()=>{if(!e.formId)return i.error("\u975E\u6CD5\u64CD\u4F5C."),!1;const t={id:e.formId};j("designById",t).then(a=>{var s;const o=a.data;o&&Object.keys(o).length&&(e.formData=x(o.data),e.dict=q(o.dict),(r.id||((s=e.formData.config)==null?void 0:s.addLoad))&&n.value.getData({formId:e.formId,id:r.id}),d.changeBreadcrumb([{label:"\u5185\u5BB9\u7BA1\u7406"},{label:o.name}])),M(()=>{e.loading=!1})}).catch(a=>{e.loading=!1,i.error(a.message||"\u975E\u6CD5\u64CD\u4F5C..")})},m=t=>(t.formId=e.formId,t.id=r.id,t),l=t=>{t==="success"&&c.go(-1)};return h(()=>{f()}),(t,a)=>{const o=v("ak-form"),s=I("loading");return B((k(),E("div",O,[F(o,{ref_key:"formEl",ref:n,formData:e.formData,type:S(u),dict:e.dict,requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent",beforeSubmit:m,afterSubmit:l},null,8,["formData","type","dict"])])),[[s,e.loading]])}}});export{U as default};
