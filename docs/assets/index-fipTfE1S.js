import{d as h,l as a,G as I,H as B,p as T,r as u,o as v,b as L,x as D,I as R,u as E,J as q,L as w,c as z,i as b,w as K,q as g}from"./index-PaNBskVU.js";const S=h({__name:"content",props:{modelValue:{}},emits:["update:modelValue"],setup(_,{emit:m}){const l=_,i=m,n=a(),r=a([]),c={children:"children",label:"name"},t=()=>{const o=n.value.getCheckedKeys(!1);i("update:modelValue",o.join(","))},p=()=>{D("menuList",{status:1}).then(o=>{r.value=R(o.data.list)})},f=I(()=>l.modelValue,()=>{l.modelValue&&n.value.setCheckedKeys(l.modelValue.split(","),!1)});return B(()=>{f()}),T(()=>{p()}),(o,y)=>{const k=u("el-tree");return v(),L(k,{ref_key:"treeRef",ref:n,data:r.value,"show-checkbox":"","node-key":"id","highlight-current":"",props:c,onCheckChange:t},null,8,["data"])}}}),N=h({__name:"index",setup(_){const m=E(),l=a(),i=a(),n=a({list:[{type:"input",control:{modelValue:"",placeholder:"请输入角色名称"},config:{},name:"name",formItem:{label:"角色名称"}},{type:"select",control:{modelValue:"",appendToBody:!0},options:[],config:{optionsType:2,addAll:"全部",optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}}],form:{size:"default"},config:{submitCancel:!0}}),r=a({columns:[{label:"多选",type:"selection"},{label:"序号",type:"index",width:"70px"},{label:"角色名称",prop:"name"},{label:"状态",prop:"status",config:{dictKey:"sys-status",tagList:{1:"success",0:"info"}}},{label:"操作",prop:"__control"}],config:{expand:!0,openType:"dialog"},operateBtn:[{label:"分配用户",click:e=>{m.push({path:"/system/user",query:{role:e.id}})}},{label:"编辑",key:"edit",click:e=>{g(()=>{console.log(e)})}},{label:"删除",key:"del"}],controlBtn:[{label:"新增",key:"add",type:"primary",size:"small",icon:"plus"},{label:"批量删除",key:"del",type:"danger",size:"small",icon:"delete"}]}),c=a({list:[{type:"input",control:{modelValue:""},config:{},name:"name",formItem:{label:"角色名称"},customRules:[{type:"required",message:"角色名称不能为空",trigger:"blur"}]},{type:"radio",control:{modelValue:1},options:[],config:{optionsType:2,optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}},{type:"component",control:{modelValue:""},config:{componentName:q(S)},name:"menuId",formItem:{label:"菜单权限"}},{type:"textarea",control:{modelValue:""},config:{},name:"remark",formItem:{label:"备注"}}],form:{labelWidth:80,size:"default"},config:{submitCancel:!0}}),t=w({visible:!1,title:"",formType:1,dict:{},editId:""}),p=(e,s)=>{var d;(e.key==="add"||e.key==="edit")&&(t.visible=!0,t.title=e.key==="add"?"新增":"编辑",t.formType=e.key==="add"?1:2,t.editId=s&&s.id,e.key==="add"&&((d=c.value.config)!=null&&d.addLoad)&&g(()=>{l.value.getData()}),e.key==="edit"&&g(()=>{l.value.setValue(s)}))},f=e=>(t.formType===2&&(e.id=t.editId),e),o=e=>{e==="success"&&(y(),i.value.getListData())},y=()=>{t.visible=!1,t.editId=""},k=e=>{e==="reset"&&y()};return(e,s)=>{const d=u("ak-list"),V=u("ak-form"),C=u("el-dialog");return v(),z("div",null,[b(d,{ref_key:"tableListEl",ref:i,"request-url":"roleList","delete-url":"roleDelete","search-data":n.value,data:r.value,onBtnClick:p},null,8,["search-data","data"]),b(C,{"destroy-on-close":"",modelValue:t.visible,"onUpdate:modelValue":s[0]||(s[0]=x=>t.visible=x),title:t.title,width:"420px"},{default:K(()=>[b(V,{ref_key:"formEl",ref:l,data:c.value,dict:t.dict,type:t.formType,"submit-url":"roleSave","edit-url":"roleEdit","before-submit":f,"after-submit":o,onBtnClick:k},null,8,["data","dict","type"])]),_:1},8,["modelValue","title"])])}}});export{N as default};
