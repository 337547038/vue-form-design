var de=Object.defineProperty,ue=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var oe=(c,i,p)=>i in c?de(c,i,{enumerable:!0,configurable:!0,writable:!0,value:p}):c[i]=p,J=(c,i)=>{for(var p in i||(i={}))fe.call(i,p)&&oe(c,p,i[p]);if(ae)for(var p of ae(i))pe.call(i,p)&&oe(c,p,i[p]);return c},M=(c,i)=>ue(c,me(i));import{h as he,v as be,a as ve}from"./vueFile.d738ec56.js";import{G as ge,p as $,j as W,q as ee,r as y,o as s,y as v,F,B as A,h as S,x as X,a as r,w as o,K as te,c as g,v as O,A as x,H as se,S as ce,l as ye,s as _e,i as ne,Q as De,U as Ve,I as ke,E as z,P as Ce}from"./vendor.df12524c.js";import{_ as le,a as we,d as Se,b as Ue,s as Ne}from"./index.2eb78c65.js";import{o as K,l as Y,s as re}from"./index.6c162138.js";const Z=[{label:"label1",value:"value1"},{label:"label2",value:"value2"},{label:"label3",value:"value3"}],G={type:"fixed",source:0,request:"get",sourceFun:""};var ie=[{title:"\u57FA\u7840\u5B57\u6BB5",children:[{type:"input",label:"\u5355\u884C\u6587\u672C",icon:"input",control:{modelValue:""},config:{}},{type:"textarea",label:"\u591A\u884C\u6587\u672C",icon:"textarea",control:{modelValue:""},config:{}},{type:"radio",label:"\u5355\u9009\u6846\u7EC4",icon:"radio",control:{modelValue:""},options:Z,config:G},{type:"checkbox",label:"\u591A\u9009\u6846\u7EC4",icon:"checkbox",control:{modelValue:[]},options:Z,config:G},{type:"select",label:"\u4E0B\u62C9\u9009\u62E9\u6846",icon:"select",control:{modelValue:[],appendToBody:!0},options:Z,config:G},{type:"datePicker",label:"\u65E5\u671F\u9009\u62E9\u5668",icon:"date",control:{modelValue:"",type:"date"},config:{}},{type:"timePicker",label:"\u65F6\u95F4\u9009\u62E9\u5668",icon:"time",control:{modelValue:""},config:{}},{type:"colorPicker",label:"\u53D6\u8272\u5668",icon:"color",control:{modelValue:""},config:{}},{type:"switch",label:"\u5F00\u5173",icon:"switch",control:{modelValue:!1},config:{}},{type:"number",label:"\u8BA1\u6570\u5668",icon:"number",control:{modelValue:""},config:{}},{type:"cascader",label:"\u7EA7\u8054\u9009\u62E9\u5668",icon:"cascader",control:{modelValue:[]},options:[],config:G},{type:"rate",label:"\u8BC4\u5206",icon:"rate",control:{modelValue:""},config:{}},{type:"slider",label:"\u6ED1\u5757",icon:"slider",control:{modelValue:""},config:{}},{type:"txt",label:"\u6587\u5B57",icon:"text",control:{modelValue:""},config:{}},{type:"title",label:"\u6807\u9898",icon:"title",control:{modelValue:"\u6807\u9898"},config:{}}]},{title:"\u9AD8\u7EA7\u5B57\u6BB5",children:[{type:"table",label:"\u5B50\u8868",icon:"table",list:[],tableData:[],control:{border:!0},config:{}},{type:"component",label:"\u81EA\u5B9A\u4E49\u7EC4\u4EF6",icon:"component",control:{modelValue:""},config:{}},{type:"upload",label:"\u56FE\u7247/\u6587\u4EF6",icon:"image",control:{modelValue:[]},config:{}},{type:"tinymce",label:"tinymce\u5BCC\u6587\u672C",icon:"tinymce",control:{modelValue:""},config:{}}]},{title:"\u5E03\u5C40\u5B57\u6BB5",children:[{type:"grid",label:"\u683C\u6805\u5E03\u5C40",icon:"grid",columns:[{attr:{span:12},list:[]},{attr:{span:12},list:[]}],control:{},config:{}},{type:"tabs",label:"\u6807\u7B7E\u9875",icon:"tabs",columns:[{label:"Tab1",list:[]}],control:{},config:{}},{type:"card",label:"\u5361\u7247\u5E03\u5C40",icon:"card",list:[],control:{},config:{},item:{}},{type:"divider",label:"\u5206\u5272\u7EBF",icon:"divider",control:{},config:{}}]}];const xe={name:"formControl",props:{formData:Object,searchData:Object,searchDesign:Boolean},components:{Draggable:ge},setup(c){const i=$({selectValue:[]}),p=W(()=>c.searchDesign?ie.slice(0,1):ie),l=(b,f)=>{if(f){const u=JSON.parse(JSON.stringify(b));u.rules=[],u.customRules=[],c.searchData.list.push(u)}else c.searchData.list.forEach((u,_)=>{u.name===b.name&&c.searchData.list.splice(_,1)})},t=b=>{let f=!1;return c.searchData.list.forEach(u=>{u.name===b&&(f=!0)}),f},V=W(()=>{const b=[];return k(c.formData,b),b}),n=["txt","title","table","component","upload"],k=(b,f)=>{b.forEach(u=>{u.type==="grid"||u.type==="tabs"?u.columns.forEach(_=>{k(_.list,f)}):u.type==="card"?k(u.list,f):n.indexOf(u.type)===-1&&f.push(u)})};return M(J({controlList:p,selectChange:l,getCheckbox:t},ee(i)),{formDataList:V})}},Oe={class:"components-list"},Le={class:"title"},Fe=["title"],Pe={key:0},Re=S("div",{class:"title"},"\u5DF2\u6709\u8868\u5355\u5B57\u6BB5",-1),Te={class:"content"};function Ae(c,i,p,l,t,V){const n=y("draggable"),k=y("el-checkbox");return s(),v("div",Oe,[(s(!0),v(F,null,A(l.controlList,(b,f)=>(s(),v("div",{key:f},[S("div",Le,X(b.title),1),r(n,{itemKey:"key123",tag:"ul",modelValue:b.children,"onUpdate:modelValue":u=>b.children=u,group:{name:"form",pull:"clone",put:!1},"ghost-class":"ghost",sort:!1},{item:o(({element:u})=>[S("li",{class:te([u.type])},[S("i",{class:te(`icon-${u.icon}`)},null,2),S("span",{title:u.label},X(u.label),9,Fe)],2)]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128)),p.searchDesign?(s(),v("div",Pe,[Re,S("div",Te,[(s(!0),v(F,null,A(l.formDataList,b=>(s(),g(k,{key:b.name,checked:l.getCheckbox(b.name),onChange:f=>l.selectChange(b,f)},{default:o(()=>[O(X(b.item.label),1)]),_:2},1032,["checked","onChange"]))),128))])])):x("",!0)])}var Ee=le(xe,[["render",Ae]]);const qe={name:"formControlAttr",components:{},props:{formConfig:Object,linkageValue:Object,formStyle:String},emits:["openDialog","update:formStyle"],setup(c,{emit:i}){const p=se(),l=ce(),t=l.query.formName,V=$({formAttr:[{label:"\u8868\u5355\u540D\u79F0",value:"name"},{label:"\u8868\u5355\u6807\u7B7E\u5BBD\u5EA6",value:"labelWidth"},{label:"\u8868\u5355\u6837\u5F0F\u540D\u79F0",value:"class"},{label:"\u7EC4\u4EF6\u5C3A\u5BF8",value:"size",type:"select",options:[{label:"large",value:"large"},{label:"default",value:"default"},{label:"small",value:"small"}]}],dataSourceList:{},customRulesList:[{type:"required",label:"\u5FC5\u586B"},{type:"mobile",label:"\u624B\u673A\u53F7\u7801"},{type:"tel",label:"\u56FA\u8BDD"},{type:"phone",label:"\u56FA\u8BDD\u6216\u624B\u673A"},{type:"email",label:"\u90AE\u7BB1"},{type:"int",label:"\u6B63\u6574\u6570"},{type:"number",label:"\u6570\u5B57"},{type:"card",label:"\u8EAB\u4EFD\u8BC1"},{type:"rules",label:"\u81EA\u5B9A\u4E49\u6B63\u5219"},{type:"methods",label:"\u81EA\u5B9A\u4E49\u65B9\u6CD5"}],searchDesign:l.query.type==="search",attrList:[]});t&&we(t).then(a=>{a.data.code===200&&a.data.data.forEach(h=>{V.dataSourceList[h.label||h.value]=h.value}),V.loading=!1}).catch(a=>{console.log(a)});const n=W(()=>p.state.form.controlAttr);ye(()=>n.value,a=>{Object.keys(a).length>0?k():V.attrList=[]});const k=()=>{const{control:a={},className:h="",type:w,name:H,config:C={},item:q={},attr:j={}}=n.value;let I=!1,B=!1;if(w==="table"){const R=n.value&&n.value.list;R&&R.length>0&&(I=R[0].typeColumn==="index"),R&&R.length>0&&(B=R[R.length-1].typeColumn==="operate")}V.attrList=[{label:"\u81EA\u5B9A\u4E49Class",value:h,placeholder:"\u6837\u5F0F\u7C7B\u540D",path:"className"},{label:"\u5B57\u6BB5\u6807\u8BC6",value:H,type:Object.keys(V.dataSourceList).length>0?"select":"text",placeholder:"\u5B57\u6BB5\u552F\u4E00\u6807\u8BC6\uFF0C\u5BF9\u5E94\u6570\u636E\u5E93",dict:V.dataSourceList,path:"name",vHide:["grid","tabs","card","title","gridChild","tableColumn","divider"],eventName:"filedNameKey"},{label:"\u5360\u4F4D\u5185\u5BB9",value:a.placeholder,placeholder:"placeholder",path:"control.placeholder",vShow:["input","textarea","select","date","number","datePicker","tinymce","timePicker"]},{label:"label\u503C",value:q.label,path:"item.label",vHide:["table","grid","tabs","title","gridChild"]},{label:"\u9690\u85CFlabel",value:q.showLabel,path:"item.showLabel",type:"switch",vHide:["table","grid","tabs","title","gridChild","divider","card"]},{label:"\u5E2E\u52A9\u4FE1\u606F",value:C.help,path:"config.help",vHide:["table","grid","tabs","title","gridChild","divider"]},{label:"\u8868\u5355\u6805\u683C",value:C.span,placeholder:"\u8868\u5355\u533A\u57DF\u6805\u683C\u5BBD",path:"config.span",vHide:["table","grid","gridChild","divider"]},{label:"\u6587\u672C\u503C",value:a.modelValue,placeholder:"\u652F\u6301html",path:"control.modelValue",vShow:["txt"],inputStyle:"textarea"},{label:"\u8BBE\u4E3A\u5BC6\u7801",value:w,type:"select",dict:{\u6587\u672C:"input",\u5BC6\u7801:"password"},path:"type",vShow:["input","password"]},{label:"\u6587\u672C\u57DF\u9AD8\u5EA6",value:a.rows,placeholder:"\u8F93\u5165\u6846\u884C\u6570",path:"control.rows",vShow:["textarea"]},{label:"\u524D\u7F00",value:C.prepend,placeholder:"\u6587\u672C\u524D\u7F00",path:"config.prepend",vShow:["input"]},{label:"\u540E\u7F00",value:C.append,placeholder:"\u6587\u672C\u540E\u7F00",path:"config.append",vShow:["input"]},{label:"\u662F\u5426\u591A\u9009",value:a.multiple,path:"control.multiple",type:"switch",vShow:["select"],eventName:"selectMultiple"},{label:"\u662F\u5426\u7981\u7528",value:a.disabled,path:"control.disabled",type:"switch",vShow:["input","textarea","radio","checkbox","select","date","switch","number","cascader","upload","rate","tinymce"]},{label:"\u662F\u5426\u7981\u7528\u7F16\u8F91",value:C.editDisabled,path:"config.editDisabled",type:"switch",vShow:["input","textarea","radio","checkbox","select","date","switch","number","cascader","upload"]},{label:"\u6DFB\u52A0\u9875\u9690\u85CF",value:C.disabledAdd,path:"config.disabledAdd",type:"switch"},{label:"\u7F16\u8F91\u9875\u9690\u85CF",value:C.disabledEdit,path:"config.disabledEdit",type:"switch"},{label:"\u8BE6\u60C5\u9875\u9690\u85CF",value:C.disabledDetail,path:"config.disabledDetail",type:"switch"},{label:"\u6807\u9898",value:a.modelValue,path:"control.modelValue",vShow:["title"]},{label:"\u5360\u636E\u7684\u5217\u6570span",value:j.span,path:"attr.span",vShow:["gridChild"],eventName:"formatNumber"},{label:"\u5DE6\u4FA7\u7684\u95F4\u9694\u683C\u6570offset",value:j.offset,path:"attr.offset",vShow:["gridChild"],eventName:"formatNumber"},{label:"\u5411\u53F3\u79FB\u52A8\u683C\u6570push",value:j.push,path:"attr.push",vShow:["gridChild"],eventName:"formatNumber"},{label:"\u5411\u5DE6\u79FB\u52A8\u683C\u6570pull",value:j.pull,path:"attr.pull",vShow:["gridChild"],eventName:"formatNumber"},{label:"\u5E8F\u53F7\u5217",value:I,type:"switch",vShow:["table"],eventName:"tableColumn1"},{label:"\u64CD\u4F5C\u5217",value:B,type:"switch",vShow:["table"],eventName:"tableColumn2"},{label:"\u7EC4\u4EF6\u540D",value:C.template,placeholder:"import\u8FDB\u6765\u7684\u7EC4\u4EF6\u540D\u79F0",path:"config.template",vShow:["component"]},{label:"\u4E0A\u4F20\u5730\u5740",value:a.action,placeholder:"\u56FE\u7247/\u6587\u4EF6\u4E0A\u4F20\u5730\u5740",path:"control.action",vShow:["upload"]},{label:"\u6587\u4EF6\u5B57\u6BB5\u540D",value:a.name,placeholder:"\u4E0A\u4F20\u7684\u6587\u4EF6\u5B57\u6BB5\u540D",path:"control.name",vShow:["upload"]},{label:"\u5217\u8868\u7C7B\u578B",value:a.listType,type:"select",dict:{text:"text",picture:"picture","picture-card":"picture-card"},path:"control.listType",vShow:["upload"]},{label:"\u63D0\u793A\u6587\u5B57",value:C.tip,placeholder:"\u63D0\u793A\u8BF4\u660E\u6587\u5B57",path:"config.tip",vShow:["upload"]},{label:"\u6309\u94AE\u6587\u672C",value:C.btnText,placeholder:"\u4E0A\u4F20\u6309\u94AE\u6587\u672C",path:"config.btnText",vShow:["upload"]},{label:"direction",type:"select",dict:{horizontal:"horizontal",vertical:"vertical"},value:a.direction,path:"control.direction",vShow:["divider"]},{label:"border-style",value:a.borderStyle,path:"control.borderStyle",vShow:["divider"]},{label:"content-position",type:"select",dict:{left:"left",right:"right",center:"center"},value:a.contentPosition,path:"control.contentPosition",vShow:["divider"]},{label:"\u6700\u5C0F\u503C",value:a.min,path:"control.min",vShow:["slider"],eventName:"formatNumber"},{label:"\u6700\u5927\u503C",value:a.max,path:"control.max",vShow:["rate","slider"],eventName:"formatNumber"},{label:"\u6B65\u957F",value:a.step,path:"control.step",vShow:["slider"],eventName:"formatNumber"},{label:"type",value:a.type,path:"control.type",vShow:["datePicker"],type:"select",placeholder:"\u663E\u793A\u7C7B\u578B",dict:{year:"year",month:"month",date:"date",dates:"dates",datetime:"datetime",week:"week",datetimerange:"datetimerange",daterange:"daterange",monthrange:"monthrange"}},{label:"format",value:a.format,path:"control.format",vShow:["datePicker","timePicker"],placeholder:"\u663E\u793A\u5728\u8F93\u5165\u6846\u4E2D\u7684\u683C\u5F0F"},{label:"color-format",value:a.colorFormat,path:"control.colorFormat",type:"select",placeholder:"\u5199\u5165 v-model \u7684\u989C\u8272\u7684\u683C\u5F0F",dict:{hsl:"hsl",hsv:"hsv",hex:"hex",rgb:"rgb"},vShow:["colorPicker"]},{label:"\u6587\u672C\u9AD8\u5EA6",value:a.height,path:"control.height",placeholder:"\u6587\u672C\u9AD8\u5EA6(\u9884\u89C8\u67E5\u770B\u6548\u679C)",vShow:["tinymce"]},{label:"\u6587\u672C\u5BBD\u5EA6",value:a.width,path:"control.width",placeholder:"\u6587\u672C\u5BBD\u5EA6(\u9884\u89C8\u67E5\u770B\u6548\u679C)",vShow:["tinymce"]},{label:"\u56FE\u7247\u4E0A\u4F20\u5730\u5740",value:a.imgUrl,path:"control.imgUrl",placeholder:"\u56FE\u7247\u4E0A\u4F20\u5730\u5740",vShow:["tinymce"]},{label:"\u9644\u4EF6\u4E0A\u4F20\u5730\u5740",value:a.bloblUrl,path:"control.bloblUrl",placeholder:"\u9644\u4EF6\u4E0A\u4F20\u5730\u5740",vShow:["tinymce"]},{label:"\u663E\u793A\u6A21\u5F0F",value:C.style,path:"config.style",placeholder:"\u663E\u793A\u98CE\u683C(\u9884\u89C8\u67E5\u770B\u6548\u679C)",type:"select",dict:{default:"default",simple:"simple"},vShow:["tinymce"]}],V.attrList=V.attrList.filter(R=>{let Q=!0;return R.vShow&&(Q=R.vShow.indexOf(w)!==-1),R.vHide&&(Q=R.vHide.indexOf(w)===-1),Q})},b=(a,h)=>{switch(a.eventName){case"selectMultiple":h?n.value.control.modelValue=[]:n.value.control.modelValue="";break;case"tableColumn1":m(h);break;case"tableColumn2":m(h,1);break;case"formatNumber":h=parseInt(h);break;case"filedNameKey":for(const w in V.dataSourceList)if(V.dataSourceList[w]===h){n.value.item.label=w;return}break}a.path&&f(n.value,a.path,h)},f=(a,h,w)=>{let H=a;const C=h.split(".");let q=0;for(q;q<C.length-1;q++){const B=C[q];if(B in H)H=H[B];else throw new Error(`${B} is undefined`)}const j=C[q],I=H[C[q]];return w!==void 0&&(H[j]=w),{obj:H,key:j,value:I}},u=(a,h)=>{h==="tabs"?n.value.columns.splice(a,1):n.value.options.splice(a,1)},_=a=>{n.value.type==="cascader"?U():a==="tabs"?n.value.columns.push({label:"\u6807\u7B7E\u540D\u79F0",list:[]}):n.value.options.push({label:"",value:""})},U=()=>{let a=n.value.control;n.value.type==="cascader"&&(a=n.value.options),i("openDialog",a,h=>{n.value.type==="cascader"?n.value.options=h:(n.value.control={},Object.assign(n.value.control,h))})},T=a=>{a?n.value.rules.push({required:!0,message:"\u5FC5\u586B\u9879",trigger:"change"}):n.value.rules.splice(0,1)},E=()=>{i("openDialog",n.value.rules,a=>{Object.assign(n.value.rules,a)})},P=(a,h)=>{if(a&&a.length===0||Object.keys(n.value).length===0)return!1;const w=a.indexOf(n.value.type);return h?w!==-1:w===-1},m=(a,h)=>{const w={name:"",type:"tableColumn",typeColumn:h?"operate":"index",item:{label:h?"\u64CD\u4F5C":"\u5E8F\u53F7"},control:{type:h?"":"index"},config:{}};a?h?n.value.list.push(w):n.value.list.unshift(w):h?n.value.list.splice(n.value.list.length-1,1):n.value.list.splice(0,1)},D=W(()=>{const a=n.value&&n.value.rules;return a&&a.length>0}),N=()=>{n.value.customRules&&n.value.customRules.push({type:"required",message:"",trigger:"blur"})},e=a=>{n.value.customRules&&n.value.customRules.splice(a,1)},L=()=>{i("openDialog",c.formConfig.rulesComm,a=>{Object.assign(c.formConfig.rulesComm,a)})},d=()=>{i("openDialog",c.formStyle||"",a=>{i("update:formStyle",a)},"css")};return M(J({},ee(V)),{controlData:n,delSelectOption:u,addSelectOption:_,openAttrDialog:U,requiredChange:T,addRules:E,showHide:P,tableColumnAdd:m,checkboxRequired:D,addRulesFast:N,delAddRules:e,rulesCommClick:L,editFormStyle:d,controlChange:b})}},He={class:"sidebar-tools"},je=S("h3",null,"\u901A\u7528\u5C5E\u6027",-1),ze=O("="),Be=S("h3",null,"\u6807\u7B7E\u914D\u7F6E\u9879",-1),Ke=["onClick"],Ie=O("\u589E\u52A0\u6807\u7B7E"),Je={key:2},Me=S("h3",null,"\u9009\u9879\u914D\u7F6E",-1),Ge={key:0},We=["onClick"],Qe=O("\u65B0\u589E"),Xe=O("\u6570\u636E\u6E90"),Ye=O("\u65B9\u6CD5\u51FD\u6570"),Ze=S("h3",null,"\u6821\u9A8C\u8BBE\u7F6E",-1),$e={key:0},el=O("\u5FEB\u901F\u6DFB\u52A0"),ll=O("\u7F16\u8F91\u6821\u9A8C\u89C4\u5219"),al=O("\u5FC5\u586B"),ol={key:4},tl=S("h3",null,"\u5176\u4ED6\u5C5E\u6027",-1),nl=O("\u6DFB\u52A0\u5C5E\u6027"),rl=O("\u7F16\u8F91\u5168\u5C40\u6821\u9A8C\u89C4\u5219"),il=O("\u7F16\u8F91\u8868\u5355\u6837\u5F0F");function sl(c,i,p,l,t,V){const n=y("el-option"),k=y("el-select"),b=y("el-switch"),f=y("el-input"),u=y("el-form-item"),_=y("el-col"),U=y("el-button"),T=y("el-tab-pane"),E=y("el-radio"),P=y("el-radio-group"),m=y("el-tabs"),D=y("el-checkbox"),N=y("el-form");return s(),v("div",He,[r(m,{modelValue:"first"},{default:o(()=>[r(T,{label:"\u5B57\u6BB5\u5C5E\u6027",name:"first"},{default:o(()=>[r(N,{size:"small",class:"form"},{default:o(()=>[je,(s(!0),v(F,null,A(c.attrList,(e,L)=>(s(),g(u,{key:L,label:e.label},{default:o(()=>[e.type==="select"?(s(),g(k,{key:0,placeholder:e.placeholder,modelValue:e.value,"onUpdate:modelValue":d=>e.value=d,onChange:d=>l.controlChange(e,d)},{default:o(()=>[(s(!0),v(F,null,A(e.dict,(d,a)=>(s(),g(n,{key:d,value:d,label:a},null,8,["value","label"]))),128))]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue","onChange"])):e.type==="switch"?(s(),g(b,{key:1,modelValue:e.value,"onUpdate:modelValue":d=>e.value=d,onChange:d=>l.controlChange(e,d)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(s(),g(f,{key:2,type:e.inputStyle,modelValue:e.value,"onUpdate:modelValue":d=>e.value=d,placeholder:e.placeholder,onChange:d=>l.controlChange(e,d)},null,8,["type","modelValue","onUpdate:modelValue","placeholder","onChange"]))]),_:2},1032,["label"]))),128)),l.showHide(["input","textarea","radio","checkbox","select","date","switch","number","cascader"],!0)?(s(),g(u,{key:0,label:"\u8054\u52A8\u6761\u4EF6"},{default:o(()=>[r(_,{span:9},{default:o(()=>[r(f,{placeholder:"\u6807\u8BC6\u540D\u79F0",modelValue:l.controlData.config.linkKey,"onUpdate:modelValue":i[0]||(i[0]=e=>l.controlData.config.linkKey=e)},null,8,["modelValue"])]),_:1}),r(_,{span:2,offset:1},{default:o(()=>[ze]),_:1}),r(_,{span:9,offset:1},{default:o(()=>[r(f,{placeholder:"\u5173\u8054\u503C",modelValue:l.controlData.config.linkValue,"onUpdate:modelValue":i[1]||(i[1]=e=>l.controlData.config.linkValue=e)},null,8,["modelValue"])]),_:1})]),_:1})):x("",!0),l.showHide(["tabs"],!0)?(s(),v(F,{key:1},[Be,(s(!0),v(F,null,A(l.controlData.columns,(e,L)=>(s(),g(u,{key:L},{default:o(()=>[r(_,{span:12},{default:o(()=>[r(f,{placeholder:"\u6807\u7B7E\u914D\u7F6E\u9879",modelValue:e.label,"onUpdate:modelValue":d=>e.label=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(_,{span:2,offset:1},{default:o(()=>[S("i",{class:"icon-del",onClick:d=>l.delSelectOption(L,"tabs")},null,8,Ke)]),_:2},1024)]),_:2},1024))),128)),r(u,null,{default:o(()=>[r(U,{onClick:i[2]||(i[2]=e=>l.addSelectOption("tabs"))},{default:o(()=>[Ie]),_:1})]),_:1})],64)):x("",!0),l.showHide(["radio","select","checkbox","cascader"],!0)?(s(),v("div",Je,[Me,r(m,{modelValue:l.controlData.config.type,"onUpdate:modelValue":i[6]||(i[6]=e=>l.controlData.config.type=e)},{default:o(()=>[r(T,{label:"\u56FA\u5B9A\u9009\u9879",name:"fixed"},{default:o(()=>[l.controlData.type!=="cascader"?(s(),v("div",Ge,[(s(!0),v(F,null,A(l.controlData.options,(e,L)=>(s(),g(u,{key:L},{default:o(()=>[r(_,{span:10},{default:o(()=>[r(f,{placeholder:"\u9009\u9879\u6807\u7B7E",modelValue:e.label,"onUpdate:modelValue":d=>e.label=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(_,{span:10,offset:1},{default:o(()=>[r(f,{placeholder:"\u9009\u9879\u503C",modelValue:e.value,"onUpdate:modelValue":d=>e.value=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),r(_,{span:2,offset:1},{default:o(()=>[S("i",{class:"icon-del",onClick:d=>l.delSelectOption(L)},null,8,We)]),_:2},1024)]),_:2},1024))),128))])):x("",!0),r(u,null,{default:o(()=>[r(U,{onClick:l.addSelectOption},{default:o(()=>[Qe]),_:1},8,["onClick"])]),_:1})]),_:1}),r(T,{label:"\u52A8\u6001\u9009\u9879",name:"async"},{default:o(()=>[r(P,{modelValue:l.controlData.config.source,"onUpdate:modelValue":i[3]||(i[3]=e=>l.controlData.config.source=e)},{default:o(()=>[r(E,{label:0},{default:o(()=>[Xe]),_:1}),r(E,{label:1},{default:o(()=>[Ye]),_:1})]),_:1},8,["modelValue"]),r(u,null,{default:o(()=>[r(f,{modelValue:l.controlData.config.sourceFun,"onUpdate:modelValue":i[5]||(i[5]=e=>l.controlData.config.sourceFun=e),placeholder:l.controlData.config.source?"\u65B9\u6CD5\u51FD\u6570\u540D":"\u6570\u636E\u6E90\u63A5\u53E3URL"},_e({_:2},[l.controlData.config.source?void 0:{name:"prepend",fn:o(()=>[r(k,{modelValue:l.controlData.config.request,"onUpdate:modelValue":i[4]||(i[4]=e=>l.controlData.config.request=e),style:{width:"80px"}},{default:o(()=>[r(n,{label:"get",value:"get"}),r(n,{label:"post",value:"post"})]),_:1},8,["modelValue"])])}]),1032,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):x("",!0),l.showHide(["txt","title","table","grid","tabs","card","switch","gridChild","tableColumn","divider"])&&!c.searchDesign?(s(),v(F,{key:3},[Ze,l.showHide(["input","password","component"],!0)?(s(),v("div",$e,[p.formConfig.rulesComm&&p.formConfig.rulesComm.length>0?(s(),g(u,{key:0},{default:o(()=>[r(k,{placeholder:"\u5FEB\u901F\u9009\u62E9",multiple:!0,modelValue:l.controlData.rulesComm,"onUpdate:modelValue":i[7]||(i[7]=e=>l.controlData.rulesComm=e)},{default:o(()=>[(s(!0),v(F,null,A(p.formConfig.rulesComm,e=>(s(),g(n,{label:e.message,value:e.key,key:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):x("",!0),(s(!0),v(F,null,A(l.controlData.customRules,(e,L)=>(s(),g(u,{key:e.type},{default:o(()=>[r(f,{modelValue:e.message,"onUpdate:modelValue":d=>e.message=d,placeholder:"\u6821\u9A8C\u63D0\u793A\u4FE1\u606F"},{prepend:o(()=>[r(k,{modelValue:e.type,"onUpdate:modelValue":d=>e.type=d,style:{width:"80px"}},{default:o(()=>[(s(!0),v(F,null,A(c.customRulesList,d=>(s(),g(n,{key:d.type,label:d.label,value:d.type},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),append:o(()=>[r(U,{icon:"icon-del",onClick:d=>l.delAddRules(L)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"]),e.type==="rules"?(s(),g(f,{key:0,placeholder:"\u6B63\u5219\u8868\u8FBE\u5F0F",modelValue:e.rules,"onUpdate:modelValue":d=>e.rules=d},null,8,["modelValue","onUpdate:modelValue"])):x("",!0),e.type==="methods"?(s(),g(f,{key:1,placeholder:"\u65B9\u6CD5\u540D\u79F0",modelValue:e.methods,"onUpdate:modelValue":d=>e.methods=d},null,8,["modelValue","onUpdate:modelValue"])):x("",!0)]),_:2},1024))),128)),r(u,null,{default:o(()=>[r(U,{onClick:l.addRulesFast},{default:o(()=>[el]),_:1},8,["onClick"]),r(U,{onClick:l.addRules},{default:o(()=>[ll]),_:1},8,["onClick"])]),_:1})])):(s(),g(u,{key:1},{default:o(()=>[r(D,{modelValue:l.checkboxRequired,onChange:l.requiredChange},{default:o(()=>[al]),_:1},8,["modelValue","onChange"]),l.controlData.rules&&l.controlData.rules[0]?(s(),g(f,{key:0,placeholder:"\u81EA\u5B9A\u4E49\u5FC5\u586B\u9519\u8BEF\u63D0\u793A",modelValue:l.controlData.rules[0].message,"onUpdate:modelValue":i[8]||(i[8]=e=>l.controlData.rules[0].message=e)},null,8,["modelValue"])):x("",!0)]),_:1}))],64)):x("",!0),l.showHide(["grid","card","gridChild","divider"])?(s(),v("div",ol,[tl,r(U,{size:"small",onClick:l.openAttrDialog},{default:o(()=>[nl]),_:1},8,["onClick"])])):x("",!0)]),_:1})]),_:1}),r(T,{label:"\u8868\u5355\u5C5E\u6027",name:"second"},{default:o(()=>[r(N,{size:"small",class:"form"},{default:o(()=>[(s(!0),v(F,null,A(c.formAttr,(e,L)=>(s(),g(u,{label:e.label,key:L},{default:o(()=>[e.type==="select"?(s(),g(k,{key:0,modelValue:p.formConfig[e.value],"onUpdate:modelValue":d=>p.formConfig[e.value]=d},{default:o(()=>[(s(!0),v(F,null,A(e.options,d=>(s(),g(n,{label:d.label,key:d.label,value:d.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(s(),g(f,{key:1,modelValue:p.formConfig[e.value],"onUpdate:modelValue":d=>p.formConfig[e.value]=d,placeholder:e.placeholder},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]),_:2},1032,["label"]))),128)),r(u,null,{default:o(()=>[r(U,{onClick:l.rulesCommClick},{default:o(()=>[rl]),_:1},8,["onClick"]),r(U,{onClick:l.editFormStyle},{default:o(()=>[il]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})])}var cl=le(qe,[["render",sl]]);const dl={name:"designIndex",components:{headTools:he,formControl:Ee,formDesign:Se,formControlAttr:cl,vueFile:be},setup(c,{emit:i}){const p=se(),l=ce().query,t=$({formData:{list:[],config:{labelWidth:"",class:"",size:"default",name:"form"+new Date().getTime(),rulesComm:[]}},visibleDialog:!1,sourceDialog:"",editor:{},loading:!1,drawerDirection:"rtl",formDataPreview:{},previewVisible:!1,searchDesign:l.type==="search",formDataList:[],editCodeType:""}),V=ne(),n=l.id,k=l.formName;if(n&&(t.loading=!0,Ue(n).then(m=>{if(m.data.code===200)if(t.searchDesign){const D=m.data.data[0].searchData;t.formData=D?K(D):[],t.formDataList=K(m.data.data[0].formData).list}else t.formData=K(m.data.data[0].formData);t.loading=!1}).catch(m=>{console.log(m),t.loading=!1})),!n&&!k){const m=Y();m&&(t.searchDesign?(m.searchData&&(t.formData=m.searchData),m.formData&&(t.formDataList=m.formData.list)):m.formData&&(t.formData=m.formData))}const b=m=>{switch(t.sourceDialog="",m){case"del":t.formData.list=[],t.formData.config.rulesComm=[],p.commit("setActiveKey",""),p.commit("setControlAttr",{});break;case"eye":t.previewVisible=!0;let D=K(t.formData);const N=t.formData.config.name,e=new RegExp(`get${N}ControlByName`,"g");D=D.replace(e,`getPreview${N}ControlByName`),t.formDataPreview=re(D),t.formDataPreview.config.name=`Preview${N}`;break;case"json":_(t.formData);break;case"save":u();break;case"vue":V.value.open(t.formData);break;case"import":_({});break}},f=()=>{try{const m=t.editor.getValue();let D=m;t.editCodeType!=="css"&&(D=re(m)),t.sourceDialog?t.sourceDialog(D):t.formData=D,t.visibleDialog=!1}catch(m){z.error(m.message)}},u=()=>{const m=K(t.formData),D=t.searchDesign?"searchData":"formData";if(!k)Y(D,t.formData),z.info("\u6570\u636E\u5DF2\u6682\u5B58\u5728localStorage");else{let N={formData:m,id:l.id,formName:t.formData.config.name,dataTableName:k};t.searchDesign&&(N={searchData:m,id:l.id}),t.loading=!0,Ne(N).then(e=>{e.data.code===200?z({message:"\u4FDD\u5B58\u6210\u529F\uFF01",type:"success"}):z.error(e.data.message),t.loading=!1}).catch(e=>{Y(D,t.formData),z.info("\u8BF7\u6C42\u5F02\u5E38\uFF0C\u6570\u636E\u5DF2\u6682\u5B58\u5728localStorage"),t.loading=!1})}p.commit("setActiveKey",""),p.commit("setControlAttr",{})},_=(m,D,N)=>{t.drawerDirection=D?"ltr":"rtl",t.sourceDialog=D,t.visibleDialog=!0,t.editCodeType=N;let e=K(m,!0);N==="css"&&(e=m),Ce(()=>{t.editor=ve(e,"",N)})},U=m=>{T(),m()},T=()=>{t.visibleDialog=!1,t.sourceDialog=""},E=ne(),P=()=>{E.value.validate(m=>{if(m)z.success("\u6821\u9A8C\u901A\u8FC7");else return z.error("\u6821\u9A8C\u4E0D\u901A\u8FC7"),!1})};return De(()=>{Object.keys(t.editor).length!==0&&(t.editor.destroy(),t.editor.container.remove())}),M(J({},ee(t)),{headToolClick:b,dialogConfirm:f,dialogOpen:_,drawerBeforeClose:U,dialogCancel:T,vueFileEl:V,previewForm:E,previewSubmit:P})}},ul={class:"container"},ml={class:"main-body"},fl={key:0,class:"empty-tips"},pl={class:"main-form"},hl={key:0,id:"editJson"},bl={class:"dialog-footer"},vl=O(" \u786E\u5B9A "),gl={class:"dialog-footer"},yl=O(" \u63D0\u4EA4 "),_l=O(" \u53D6\u6D88 ");function Dl(c,i,p,l,t,V){const n=y("formControl"),k=y("headTools"),b=y("form-design"),f=y("form-control-attr"),u=y("el-button"),_=y("el-drawer"),U=y("vue-File"),T=y("el-dialog"),E=Ve("loading");return s(),v("div",ul,[r(n,{formData:c.formDataList,searchData:c.formData,searchDesign:c.searchDesign},null,8,["formData","searchData","searchDesign"]),S("div",ml,[r(k,{onClick:l.headToolClick},null,8,["onClick"]),c.formData.list.length===0?(s(),v("div",fl," \u4ECE\u5DE6\u4FA7\u62D6\u62FD\u6765\u6DFB\u52A0\u5B57\u6BB5 ")):x("",!0),ke((s(),v("div",pl,[r(b,{"form-data":c.formData,type:4},null,8,["form-data"])])),[[E,c.loading]])]),r(f,{formStyle:c.formData.style,"onUpdate:formStyle":i[0]||(i[0]=P=>c.formData.style=P),formConfig:c.formData.config,onOpenDialog:l.dialogOpen},null,8,["formStyle","formConfig","onOpenDialog"]),r(_,{modelValue:c.visibleDialog,"onUpdate:modelValue":i[1]||(i[1]=P=>c.visibleDialog=P),size:"60%",direction:c.drawerDirection,"custom-class":"json-dialog","append-to-body":!0,"before-close":l.drawerBeforeClose},{default:o(()=>[c.visibleDialog?(s(),v("div",hl)):x("",!0),S("div",bl,[r(u,{type:"primary",size:"small",onClick:l.dialogConfirm},{default:o(()=>[vl]),_:1},8,["onClick"])])]),_:1},8,["modelValue","direction","before-close"]),c.searchDesign?x("",!0):(s(),g(U,{key:0,ref:"vueFileEl"},null,512)),r(T,{modelValue:c.previewVisible,"onUpdate:modelValue":i[3]||(i[3]=P=>c.previewVisible=P),title:"\u9884\u89C8",fullscreen:!0},{footer:o(()=>[S("div",gl,[r(u,{size:"small",type:"primary",onClick:l.previewSubmit},{default:o(()=>[yl]),_:1},8,["onClick"]),r(u,{size:"small",onClick:i[2]||(i[2]=P=>c.previewVisible=!1)},{default:o(()=>[_l]),_:1})])]),default:o(()=>[c.previewVisible?(s(),g(b,{key:0,"form-data":c.formDataPreview,type:1,ref:"previewForm"},null,8,["form-data"])):x("",!0)]),_:1},8,["modelValue"])])}var Ul=le(dl,[["render",Dl]]);export{Ul as default};
