import{d as D,v as B,r as n,e as C,o as x,z as E,a as S,c as T,l as r,w as d,u as F,b as a,q as i,D as v,B as R,m as c,E as U,h as V,C as N}from"./index-ea7eee8a.js";const j={class:"container-apply-start"},z=a("div",{class:"status"},[a("ul",null,[a("li",{class:"s1"},"● 已完成"),a("li",{class:"s2"},"● 进行中"),a("li",{class:"s3"},"● 未进行"),a("li",{class:"s4"},"● 已拒绝"),a("li",{class:"s5"},"● 跳过")])],-1),A=D({__name:"start",setup(L){B().changeBreadcrumb([{label:"工作台"},{label:"发起流程"}]);const t=V(),f=N(),_=n(),m=n(),p=n({list:[],form:{}}),y=n(!0),b=C(()=>t.query.id?2:1),u=n(),h=()=>{const e={id:t.query.flowId};i("designById",e).then(o=>{_.value.setValue(v(o.data.data)),u.value=o.data.source,i("designById",{id:o.data.source}).then(l=>{p.value=v(l.data.data),R(()=>{y.value=!1})});const s=t.query.id;s&&m.value.getData({formId:u.value,id:s})})},g=e=>(e.formId=u.value,t.query.id&&(e.id=t.query.id),e),w=(e,o)=>{if(e==="success"){if(t.query.id){f.push({path:"/task/applyed"});return}const s={userId:0,flowId:t.query.flowId,formId:o.data.insertId,title:"user的请假审批",creatTime:new Date};i("flowSave",s).then(()=>{f.push({path:"/task/applyed"})}).catch(l=>{console.log(l)})}else console.log("提交失败")};return x(()=>{h()}),(e,o)=>{const s=c("ak-form"),l=c("el-tab-pane"),I=c("ak-flow"),k=c("el-tabs"),q=U("loading");return E((S(),T("div",j,[r(k,null,{default:d(()=>[r(l,{label:"表单信息"},{default:d(()=>[r(s,{ref_key:"formEl",ref:m,formData:p.value,beforeSubmit:g,afterSubmit:w,type:F(b),requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent"},null,8,["formData","type"])]),_:1}),r(l,{label:"流程图",name:"flow",class:"flow-box"},{default:d(()=>[z,r(I,{type:1,ref_key:"flowEl",ref:_},null,512)]),_:1})]),_:1})])),[[q,y.value]])}}});export{A as default};
