import{r as a,H as _,b as T,B as m,o as w,c as D,p as n,w as B,i as x,I as L,q as i}from"./index.ae153a4c.js";const q={__name:"user",setup(E){const p=x(),r=a(),u=a({list:[{type:"input",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u540D\u79F0"},config:{},name:"userName",item:{label:"\u767B\u5F55\u540D\u79F0"}},{type:"input",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0"},config:{},name:"nickName",item:{label:"\u6635\u79F0"}},{type:"input",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"},config:{},name:"phone",item:{label:"\u624B\u673A\u53F7"}},{type:"select",control:{modelValue:"",appendToBody:!0},options:[],config:{optionsType:2,optionsFun:"status"},name:"status",item:{label:"\u7528\u6237\u72B6\u6001"}},{type:"select",control:{modelValue:[],appendToBody:!0},options:[],config:{optionsType:1,optionsFun:"roleList",method:"post",label:"name",value:"id"},name:"role",item:{label:"\u89D2\u8272"}},{type:"button",control:{label:"\u67E5\u8BE2",type:"primary",key:"submit"},config:{}},{type:"button",control:{label:"\u6E05\u7A7A",key:"reset"},config:{}}],form:{size:"default"},config:{}}),f=a({columns:[{label:"\u591A\u9009",type:"selection"},{label:"\u5E8F\u53F7",type:"index",width:"70px"},{label:"\u767B\u5F55\u540D\u79F0",prop:"userName"},{label:"\u6635\u79F0",prop:"nickName"},{label:"\u624B\u673A\u53F7\u7801",prop:"phone"},{label:"\u89D2\u8272",prop:"role"},{label:"\u72B6\u6001",prop:"status",config:{dictKey:"status",tagList:{1:"success",0:"info"}}},{prop:"dateTime",label:"\u521B\u5EFA\u65F6\u95F4",config:{formatter:"{y}-{m}-{d} {h}:{i}:{s}"}},{label:"\u64CD\u4F5C",prop:"__control"}],config:{openType:"dialog"},operateBtn:[{label:"\u7F16\u8F91",key:"edit"},{label:"\u5220\u9664",key:"del"}],controlBtn:[{label:"\u65B0\u589E",key:"add",type:"primary",size:"small",icon:"plus"},{label:"\u6279\u91CF\u5220\u9664",key:"del",type:"danger",size:"small",icon:"delete"}],treeData:{show:!0,treeProps:{props:{label:"name"}},name:"department",method:"post",requestUrl:"deptList",afterResponse:"transformDataToChild"}}),d=a(),y=a({list:[{type:"input",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0"},config:{},name:"userName",item:{label:"\u7528\u6237\u540D\u79F0"},customRules:[{type:"required",message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",trigger:"blur"}]},{type:"input",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},config:{},name:"nickName",item:{label:"\u7528\u6237\u6635\u79F0"}},{type:"password",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"},config:{},name:"password",item:{label:"\u767B\u5F55\u5BC6\u7801"},customRules:[{type:"required",message:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801",trigger:"blur"}]},{type:"password",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u786E\u8BA4\u767B\u5F55\u5BC6\u7801"},config:{},name:"password2",item:{label:"\u786E\u8BA4\u5BC6\u7801",rules:[{validator:(e,l,t)=>{const s=getuserFormValueByName("password");console.log(s),l===""?t(new Error("\u8BF7\u8F93\u5165\u5BC6\u7801")):l!==s?t(new Error("\u4E24\u6B21\u5BC6\u7801\u4E0D\u4E00\u6837")):t()},trigger:"change"}]},customRules:[{type:"required",message:"\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801",trigger:"blur"}]},{type:"input",control:{modelValue:"",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"},config:{},name:"phone",item:{label:"\u624B\u673A\u53F7\u7801"},customRules:[{type:"mobile",message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",trigger:"blur"}]},{type:"treeSelect",control:{modelValue:"",data:[],renderAfterExpand:!1},config:{optionsType:1,optionsFun:"deptList",method:"post",afterResponse:"transformDataToChild"},name:"department",item:{label:"\u5F52\u5C5E\u90E8\u95E8"}},{type:"select",control:{modelValue:"",appendToBody:!0},options:[],config:{optionsType:0},name:"post",item:{label:"\u5C97\u4F4D"}},{type:"radio",control:{modelValue:1},options:[],config:{optionsType:2,optionsFun:"status"},name:"status",item:{label:"\u72B6\u6001"}},{type:"select",control:{modelValue:[],appendToBody:!0,multiple:!0},options:[],config:{optionsType:1,optionsFun:"roleList",method:"post",label:"name",value:"id",transformData:"string"},name:"role",item:{label:"\u89D2\u8272"}},{type:"textarea",control:{modelValue:""},config:{span:24},name:"remark",item:{label:"\u5907\u6CE8"}},{type:"div",control:{},config:{span:24,textAlign:"center"},list:[{type:"button",control:{label:"\u786E\u5B9A",type:"primary",key:"submit"},config:{span:0}},{type:"button",control:{label:"\u53D6\u6D88",key:"reset"},config:{span:0}}]}],form:{size:"default",class:"form-row-2",labelWidth:"100px",name:"userForm"},config:{}}),o=_({visible:!1,title:"",formType:1,dict:{},editId:""}),b=(e,l)=>{if(e.key==="add"||e.key==="edit"){const t=L(l);o.visible=!0,o.title=e.key==="add"?"\u65B0\u589E":"\u7F16\u8F91",o.formType=e.key==="add"?1:2,o.editId=t&&t.id,e.key==="edit"&&m(()=>{console.log(t),typeof t.role=="string"?t.role=t.role.split(","):t.role=[],t.password2=t.password,d.value.setValue(t)})}},g=e=>(e.role&&(e.role=e.role.join(",")),o.formType===2&&(e.id=o.editId),delete e.password2,e),k=e=>{e==="success"&&(c(),r.value.getListData())},c=()=>{o.visible=!1,o.editId=""},h=e=>{e==="reset"&&c()};return T(()=>{p.query.role&&r.value.setSearchFormValue({role:parseInt(p.query.role)}),m(()=>{r.value.getListData()})}),(e,l)=>{const t=i("ak-list"),s=i("ak-form"),V=i("el-dialog");return w(),D("div",null,[n(t,{ref_key:"tableListEl",ref:r,requestUrl:"userList",deleteUrl:"userDelete",searchData:u.value,tableData:f.value,onBtnClick:b,autoLoad:!1},null,8,["searchData","tableData"]),n(V,{"destroy-on-close":"",modelValue:o.visible,"onUpdate:modelValue":l[0]||(l[0]=v=>o.visible=v),title:o.title,width:"600px"},{default:B(()=>[n(s,{ref_key:"formEl",ref:d,formData:y.value,dict:o.dict,type:o.formType,addUrl:"userSave",editUrl:"userEdit",beforeSubmit:g,afterSubmit:k,onBtnClick:h},null,8,["formData","dict","type"])]),_:1},8,["modelValue","title"])])}}};export{q as default};
