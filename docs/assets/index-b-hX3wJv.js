import{d as h,l as o,B as I,C as T,p as B,r as d,b as D,o as k,A as R,D as E,u as L,E as w,G as q,c as z,j as y,w as S,q as g}from"./index-D9mad5Az.js";const j=h({__name:"content",props:{modelValue:{default:""}},emits:["update:modelValue"],setup(_,{emit:u}){const a=_,i=u,n=o(),r=o([]),c={children:"children",label:"name"},t=()=>{const s=n.value.getCheckedKeys(!1);i("update:modelValue",s.join(","))},m=()=>{R("menuList",{status:1}).then(s=>{r.value=E(s.data.list)})},p=I(()=>a.modelValue,()=>{a.modelValue&&n.value.setCheckedKeys(a.modelValue.split(","),!1)});return T(()=>{p()}),B(()=>{m()}),(s,f)=>{const b=d("el-tree");return k(),D(b,{ref_key:"treeRef",ref:n,data:r.value,"show-checkbox":"","node-key":"id","highlight-current":"",props:c,onCheckChange:t},null,8,["data"])}}}),F=h({__name:"index",setup(_){const u=L(),a=o(),i=o(),n=o({list:[{type:"input",control:{modelValue:"",placeholder:"请输入角色名称"},config:{},name:"name",formItem:{label:"角色名称"}},{type:"select",control:{modelValue:"",style:{width:"100px"}},options:[],config:{optionsType:2,addAll:"全部",optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}}],form:{size:"default"},config:{submitCancel:!0}}),r=o({columns:[{label:"多选",type:"selection"},{label:"序号",type:"index",width:"70px"},{label:"角色名称",prop:"name"},{label:"状态",prop:"status",render:"tag",custom:{1:"success",0:"info"},replaceValue:"sys-status"},{label:"操作",prop:"__control",render:"buttons",buttons:[{label:"已分配用户",click:e=>{u.push({path:"/system/user",query:{roleId:e.id}})}},{label:"编辑",key:"edit",click:e=>{g(()=>{console.log(e)})}},{label:"删除",key:"del"}]}],config:{expand:!0,openType:"dialog"},controlBtn:[{label:"新增",key:"add",type:"primary",size:"small",icon:"plus"},{label:"批量删除",key:"del",type:"danger",size:"small",icon:"delete"}]}),c=o({list:[{type:"input",control:{modelValue:"",placeholder:"请输入角色名称"},config:{},name:"name",formItem:{label:"角色名称"},customRules:[{type:"required",message:"角色名称不能为空",trigger:"blur"}]},{type:"radio",control:{modelValue:1},options:[],config:{optionsType:2,optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}},{type:"component",control:{modelValue:""},config:{componentName:w(j)},name:"menuId",formItem:{label:"菜单权限"}},{type:"textarea",control:{modelValue:""},config:{},name:"remark",formItem:{label:"备注"}}],form:{labelWidth:80,size:"default"},config:{submitCancel:!0}}),t=q({visible:!1,title:"",formType:"add",dict:{},editId:""}),m=(e,l)=>{(e==="add"||e==="edit")&&(t.visible=!0,t.title=e==="add"?"新增":"编辑",t.formType=e,t.editId=l&&l.id,e==="add"&&c.value.config?.addLoad&&g(()=>{a.value.getData()}),e==="edit"&&g(()=>{a.value.setValue(l)}))},p=e=>(t.formType==="edit"&&(e.id=t.editId),e),s=(e,l)=>{l&&(f(),i.value.getListData())},f=()=>{t.visible=!1,t.editId=""},b=e=>{e==="reset"&&f()};return(e,l)=>{const v=d("ak-list"),V=d("ak-form"),C=d("el-dialog");return k(),z("div",null,[y(v,{ref_key:"tableListEl",ref:i,"api-key":{list:"roleList",del:"roleDelete"},"search-data":n.value,data:r.value,onBtnClick:m},null,8,["search-data","data"]),y(C,{modelValue:t.visible,"onUpdate:modelValue":l[0]||(l[0]=x=>t.visible=x),"destroy-on-close":"",title:t.title,width:"420px"},{default:S(()=>[y(V,{ref_key:"formEl",ref:a,data:c.value,dict:t.dict,"operate-type":t.formType,"submit-url":t.formType==="add"?"roleSave":"roleEdit",before:p,after:s,onBtnClick:b},null,8,["data","dict","operate-type","submit-url"])]),_:1},8,["modelValue","title"])])}}});export{F as default};
