import{d as x,l as a,G as C,r as p,o as d,c as w,b as E,w as f,g as b,n as D,t as L,f as B,i as y,D as N,q as c}from"./index-BR7JSMnu.js";const S={style:{"padding-left":"5px"}},z=x({__name:"menu",setup(P){const u=a(),i=a(),s={menuType:{1:"菜单",2:"按钮",3:"设计内容"}},r=a(!0),m=a({tableProps:{rowKey:"id",defaultExpandAll:!1},columns:[{label:"菜单名称",prop:"name"},{label:"地址",prop:"path"},{label:"排序",prop:"sort",width:60},{label:"类型",prop:"type",width:100,render:"tag",replaceValue:"menuType",custom:{1:"success",2:"info",3:"warning"},config:{}},{label:"状态",prop:"status",width:70,render:"tag",replaceValue:"sys-status",custom:{1:"success",2:"info"},config:{}},{label:"操作",prop:"__control",width:180,render:"buttons",buttons:[{type:"primary",label:"新增",click:e=>{t.visible=!0,t.title="新增菜单",t.formType="add",c(()=>{i.value.setValue({parentId:e.id})})}},{label:"编辑",type:"primary",click:e=>{t.visible=!0,t.title="编辑菜单",t.formType="edit",t.editId=e.id,c(()=>{i.value.setValue(e,!0)})}},{label:"删除",key:"del"}]}],controlBtn:[{label:"新增",type:"primary",icon:"plus",click:()=>{t.visible=!0,t.title="新增菜单",t.formType="add"}},{label:"展开折叠",click:()=>{m.value.tableProps.defaultExpandAll=!m.value.tableProps.defaultExpandAll,r.value=!1,c(()=>{r.value=!0})}}],config:{pageSize:"100",sort:"sort asc",fixedBottomScroll:!1}}),t=C({visible:!1,title:"",formType:"add",editId:""}),g=a({list:[{type:"input",control:{modelValue:0,disabled:!0,placeholder:"父级ID"},name:"parentId",formItem:{label:"父级ID"}},{type:"select",control:{modelValue:1},options:s.menuType,config:{optionsType:0},name:"type",formItem:{label:"类型"}},{type:"select",control:{modelValue:""},options:[],config:{optionsType:1,optionsFun:"designList",method:"post",label:"name",value:"id",hidden:"$.type!==3",debug:!0,before:e=>(e.query={type:2},e)},name:"contentList",formItem:{label:"内容列表"}},{type:"input",control:{modelValue:"",placeholder:"请输入菜单名称"},config:{},name:"name",formItem:{label:"菜单名称"},customRules:[{type:"required",message:"菜单名称不能为空",trigger:"blur"}]},{type:"input",control:{modelValue:"",placeholder:"请输入访问地址/类型标识"},config:{disabled:"$.type===3"},name:"path",formItem:{label:"访问地址"}},{type:"component",control:{modelValue:""},config:{componentName:"diyIconfont"},name:"icon",formItem:{label:"icon图标"}},{type:"inputNumber",control:{modelValue:0,controlsPosition:"right"},config:{},name:"sort",formItem:{label:"排序"}},{type:"radio",control:{modelValue:1},options:[],config:{optionsType:2,optionsFun:"sys-status"},name:"status",formItem:{label:"状态"}},{type:"radio",control:{modelValue:1},options:[{label:"显示",value:1},{label:"隐藏",value:0}],config:{optionsType:0},name:"navShow",formItem:{label:"导航显示"}},{type:"textarea",control:{modelValue:""},config:{span:24},name:"remark",formItem:{label:"备注"}}],form:{class:"form-row-2",labelWidth:"100px",size:"default"},config:{submitCancel:!0}}),v=e=>(t.formType==="edit"&&(e.id=t.editId),delete e.contentList,e),_=(e,l,o)=>{o=="submit"&&(t.visible=!1,l&&u.value.getListData())},h=e=>{e==="reset"&&(t.visible=!1)},V=(e,l,o)=>{if(console.log("after2"),l&&o==="fetch")return e.list=N(e.list),e},k=e=>{e.name==="contentList"&&(e.model.path="/design/list/content/"+e.value)};return(e,l)=>{const o=p("ak-list"),I=p("ak-form"),T=p("el-dialog");return d(),w("div",null,[r.value?(d(),E(o,{key:0,ref_key:"tableListEl",ref:u,"api-key":{list:"menuList",del:"menuDelete"},data:m.value,after:V,dict:s},{name:f(({row:n})=>[b("i",{class:D(n.icon)},null,2),b("span",S,L(n.name),1)]),_:1},8,["data"])):B("",!0),y(T,{modelValue:t.visible,"onUpdate:modelValue":l[0]||(l[0]=n=>t.visible=n),title:t.title,width:"680px","destroy-on-close":""},{default:f(()=>[y(I,{ref_key:"formNameEl",ref:i,"operate-type":t.formType,data:g.value,"submit-url":t.formType==="add"?"menuSave":"menuEdit",before:v,after:_,dict:s,onBtnClick:h,onChange:k},null,8,["operate-type","data","submit-url"])]),_:1},8,["modelValue","title"])])}}});export{z as default};
