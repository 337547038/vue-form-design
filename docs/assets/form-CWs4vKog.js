import{d as h,k,B as D,u as C,l as q,M as x,h as i,p as B,r as E,C as I,s as j,o as F,c as S,i as M,a0 as d,x as O,E as f,Z as R,q as T,G as m}from"./index-DjT9YCnt.js";const L={style:{"min-height":"300px"}},w=h({__name:"form",setup(G){const g=k(),c=D(),v=C(),u=q(),e=x({formData:{list:[],form:{},config:{}},dict:{},loading:!0}),n=i(()=>c.query.id),o=i(()=>c.query.form),p=i(()=>n.value?2:1),_=()=>{if(!o.value)return d.error("非法操作."),!1;const a={id:o.value};O("designById",a).then(r=>{var s;const t=r.data;if(t&&Object.keys(t).length){const l=f(t.data);l&&Object.keys(l).length&&(e.formData=f(t.data)),e.dict=R(t.dict),(n.value||(s=e.formData.config)!=null&&s.addLoad)&&u.value.getData({formId:o.value,id:n.value}),g.changeBreadcrumb([{label:"内容管理"},{label:t.name}])}T(()=>{e.loading=!1})}).catch(r=>{e.loading=!1,d.error(r.message||"非法操作..")})},b=a=>(a.formId=o.value,a),y=a=>{a==="success"&&v.go(-1)};return B(()=>{_()}),(a,r)=>{const t=E("ak-form"),s=I("loading");return j((F(),S("div",L,[M(t,{ref_key:"formEl",ref:u,data:e.formData,type:p.value,dict:e.dict,"request-url":"getFormContent","submit-url":"saveFormContent","edit-url":"editFormContent","before-submit":b,params:{formId:o.value.value},"after-submit":y},null,8,["data","type","dict","params"])])),[[s,e.loading]])}}});typeof m=="function"&&m(w);export{w as default};
