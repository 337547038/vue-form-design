import{y,l as a,h as b,k as _,p as v,r as g,c as k,o as h,j as s,A as w,N as n}from"./index-B4_jWQ4O.js";import{_ as E}from"./drawerCom.vue_vue_type_script_setup_true_lang-BrxmL0aV.js";import"./tabs-BUZQAtNM.js";const B={__name:"applyed",setup(L){const c=y(),l=a(),r=a(),t=b(()=>c.query.task==="copyer"),u=_();v(()=>{t.value&&u.changeBreadcrumb([{label:"工作台"},{label:"我的抄送"}])});const p=a({list:[{type:"input",control:{modelValue:"",placeholder:"请输入审批标题"},config:{},name:"title",formItem:{label:"审批标题"}}],form:{size:"default"},config:{submitCancel:!0}}),i=a({columns:[{prop:"title",label:"审批标题"},{prop:"creatTime",label:"发起时间",render:"datetime",config:{}},{prop:"endTime",label:"审批时间",render:"datetime"},{prop:"currentApprover",label:"当前审批人"},{prop:"status",label:"流程状态",render:"tag",replaceValue:"sys-flow-status",custom:{0:"primary",1:"info",2:"warning",3:"success",4:"danger",5:"danger"}},{prop:"__control",label:"操作",render:"buttons",buttons:[{type:"primary",label:"编辑",click:e=>{r.value.open(e,"applyed")},display:e=>e.status===0&&!t.value},{type:"primary",label:"查看",click:e=>{e.copyer=t.value,r.value.open(e,t.value?"copyer":"applyed")},display:e=>e.status!==0||t.value},{render:"confirm",type:"primary",label:"撤回",popConfirm:{title:"确认撤回该申请吗？"},click:e=>{[0,2].includes(e.status)&&m(e),console.log("row")},display:e=>[0,2].includes(e.status)&&!t.value}]}],config:{expand:!0}}),d=(e,o)=>{if(o==="fetch"&&t.value)return e.task="copyer",e},m=e=>{w("flowWithdraw",{id:e.id,currentNode:e.currentNode}).then(()=>{l.value.getListData(),n.success("流程申请已撤回")}).catch(()=>{n.error("流程申请撤回失败")})};return(e,o)=>{const f=g("ak-list");return h(),k("div",null,[s(f,{ref_key:"tableListEl",ref:l,"api-key":{list:"flowList"},"search-data":p.value,data:i.value,before:d},null,8,["search-data","data"]),s(E,{ref_key:"drawerEl",ref:r},null,512)])}}};export{B as default};
