import{d as B,u as C,A as E,k as S,l as s,h as y,p as N,r as u,B as R,s as T,o as V,c as F,i as o,w as c,C as j,g as e,x as A,D as b,E as w}from"./index-62047d8c.js";const L={class:"container-apply-start"},M=e("div",{class:"status"},[e("ul",null,[e("li",{class:"s1"},"● 已完成"),e("li",{class:"s2"},"● 进行中"),e("li",{class:"s3"},"● 未进行"),e("li",{class:"s4"},"● 已拒绝"),e("li",{class:"s5"},"● 跳过")])],-1),O=B({__name:"start",setup(P){C().changeBreadcrumb([{label:"工作台"},{label:"发起流程"}]);const t=E(),g=S(),i=s(),d=s(),f=s({list:[],form:{}}),_=s(!0),m=s(),p=s(),k=y(()=>({flow:{flowId:t.query.flowId,sourceId:m.value,id:t.query.id,userId:"",title:`user提交的${p.value}审批`,creatTime:new Date}})),h=y(()=>t.query.id?2:1),I=()=>{const l={id:t.query.flowId};A("flowById",l).then(v=>{const{flow:n,form:a}=v.data;i.value.setValue(b(n.data)),f.value=b(a.data),m.value=a.source,p.value=n.name,_.value=!1;const r=t.query.id;r&&d.value.getData({formId:a.id,id:r})})},q=l=>{l==="success"?g.push({path:"/task/applyed"}):console.log("提交失败")};return N(()=>{I()}),(l,v)=>{const n=u("ak-form"),a=u("el-tab-pane"),r=u("ak-flow"),D=u("el-tabs"),x=R("loading");return T((V(),F("div",L,[o(D,null,{default:c(()=>[o(a,{label:"表单信息"},{default:c(()=>[o(n,{ref_key:"formEl",ref:d,data:f.value,"after-submit":q,type:h.value,disabled:!!j(t).query.id,params:k.value,"request-url":"getFormContent","submit-url":"flowSave","edit-url":"editFormContent"},null,8,["data","type","disabled","params"])]),_:1}),o(a,{label:"流程图",name:"flow",class:"flow-box"},{default:c(()=>[M,o(r,{type:1,ref_key:"flowEl",ref:i},null,512)]),_:1})]),_:1})])),[[x,_.value]])}}});typeof w=="function"&&w(O);export{O as default};
