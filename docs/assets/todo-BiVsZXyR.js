import{d as A,l as a,h as M,i as P,G as j,p as G,r as i,c as k,o as y,F as T,j as o,w as r,f as u,t as x,m as p,q as E,A as N,N as I}from"./index-eyjXCVj4.js";import{F as R}from"./tabs-DpJY8iQn.js";const H={class:"flow-detail-drawer"},J={class:"header"},K={class:"face"},Q=["src"],W={key:1,class:"icon-user"},X={class:"name"},Y={class:"button"},Z=A({__name:"drawerTodo",setup(F,{expose:b}){const m=a(),c=M(()=>P("userInfo",!0)),l=j({visible:!1,callback:"",obj:{},loading:!0}),w=(t,e)=>{l.visible=!0,l.obj=t,l.callback=e,E(()=>{m.value.initFlowForm(t)})},s=a(),v=()=>{N("postDetail",{id:c.value.postId}).then(t=>{s.value=t.data.name})},d=a(),_=a(),g=a(),V=t=>{t==="ok"?d.value.submit({status:1,content:"同意"}):t==="no"?d.value.submit({status:0,content:"拒绝"}):t==="to"&&(_.value="",g.value="",E(()=>{C.value.open()}))},C=a(),D=t=>{var e;if(t!=null&&t.length){console.log("obj",t);const h={id:(e=l.obj)==null?void 0:e.id,userId:_.value,userName:g.value,nodeName:l.obj.currentNode};N("flowToUser",h).then(f=>{l.visible=!1,I.success(f.message),l.callback&&l.callback()}).catch(()=>{})}else I.error("请选择用户")},S=a({list:[{type:"divider",control:{},config:{},formItem:{label:"审批意见"}},{type:"radio",control:{modelValue:"1",placeholder:"请选择常用审批意见"},options:[{label:"同意",value:1},{label:"拒绝",value:0}],config:{optionsType:0,span:8},name:"status",formItem:{label:"快选审批意见"}},{type:"textarea",control:{modelValue:"同意"},config:{},name:"content",formItem:{label:"审批意见",rules:[{required:!0,message:"请输入审批意见",trigger:"change"}]}}],form:{size:"default"},config:{submitCancel:[{label:"提交审批",type:"primary",key:"submit"}]}}),B=t=>{var e;return t.id=(e=l.obj)==null?void 0:e.id,t},L=(t,e)=>{e&&(l.visible=!1,l.callback&&l.callback())},U=({name:t,value:e})=>{t==="type"&&d.value.setValue({content:e===1?"同意":"拒绝"})};return G(()=>{v()}),b({open:w}),(t,e)=>{const h=i("el-tag"),f=i("el-button"),$=i("ak-form"),q=i("el-divider"),z=i("el-drawer"),O=i("user-dialog");return y(),k(T,null,[o(z,{modelValue:l.visible,"onUpdate:modelValue":e[3]||(e[3]=n=>l.visible=n),"destroy-on-close":"","with-header":!1,size:"1200px"},{default:r(()=>[u("div",H,[u("div",J,[u("div",K,[c.value.picture?(y(),k("img",{key:0,style:{width:"40px",height:"40px","border-radius":"50%",display:"block"},src:c.value.picture,alt:""},null,8,Q)):(y(),k("i",W))]),u("div",null,[u("div",X,x(c.value.userName),1),o(h,null,{default:r(()=>[p(x(s.value)+"审批中",1)]),_:1})]),u("div",Y,[o(f,{type:"success",onClick:e[0]||(e[0]=n=>V("ok"))},{default:r(()=>e[6]||(e[6]=[p(" 一键同意 ")])),_:1}),o(f,{type:"danger",onClick:e[1]||(e[1]=n=>V("no"))},{default:r(()=>e[7]||(e[7]=[p(" 一键拒绝 ")])),_:1}),o(f,{type:"primary",onClick:e[2]||(e[2]=n=>V("to"))},{default:r(()=>e[8]||(e[8]=[p(" 流转 ")])),_:1})])]),o(R,{ref_key:"flowTabsEl",ref:m},{default:r(()=>[o($,{ref_key:"formOptionsEl",ref:d,data:S.value,"submit-url":"flowShenPi",before:B,after:L,onChange:U},null,8,["data"]),o(q,null,{default:r(()=>e[9]||(e[9]=[p("申请信息")])),_:1})]),_:1},512)])]),_:1},8,["modelValue"]),o(O,{ref_key:"userDialogEl",ref:C,modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=n=>_.value=n),"user-name":g.value,"onUpdate:userName":e[5]||(e[5]=n=>g.value=n),onChange:D},null,8,["modelValue","user-name"])],64)}}}),le={__name:"todo",setup(F){const b=a(),m=a(),c=s=>(s.task="todo",s),l=a({list:[{type:"input",control:{modelValue:"",placeholder:"请输入审批标题"},config:{},name:"title",formItem:{label:"审批标题"}}],form:{size:"default"},config:{submitCancel:!0}}),w=a({columns:[{prop:"title",label:"审批标题"},{prop:"creatTime",label:"发起时间",render:"datetime",config:{}},{prop:"status",label:"流程状态",render:"tag",replaceValue:"sys-flow-status",custom:{0:"primary",1:"info",2:"warning",3:"success",4:"danger",5:"danger"}},{prop:"__control",label:"操作",render:"buttons",buttons:[{type:"primary",label:"审批",click:s=>{const v=b.value.getListData;m.value.open(s,v)}}]}],config:{expand:!0}});return(s,v)=>{const d=i("ak-list");return y(),k(T,null,[u("div",null,[o(d,{ref_key:"tableListEl",ref:b,"api-key":{list:"flowList"},"search-data":l.value,data:w.value,before:c},null,8,["search-data","data"])]),o(Z,{ref_key:"drawerEl",ref:m},null,512)],64)}}};export{le as default};
