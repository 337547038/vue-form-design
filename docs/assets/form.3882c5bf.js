import{d as g,x as _,i as p,r as D,H as C,a as y,b,z as h,o as v,c as B,p as I,u as k,E as i,g as E,s as F,O as x,B as q,q as S,J as j,C as O}from"./index.ae153a4c.js";const R={style:{"min-height":"300px"}},L=g({__name:"form",setup(T){const d=_(),r=p().query,c=O(),n=D(),e=C({formData:{list:[],form:{},config:{}},dict:{},formId:r.form,id:r.id,loading:!0}),u=y(()=>r.id?2:1),f=()=>{if(!e.formId)return i.error("\u975E\u6CD5\u64CD\u4F5C."),!1;const t={id:e.formId};E("designById",t).then(a=>{var s;const o=a.data;o&&Object.keys(o).length&&(e.formData=F(o.data),e.dict=x(o.dict),(r.id||((s=e.formData.config)==null?void 0:s.addLoad))&&n.value.getData({formId:e.formId,id:r.id}),d.changeBreadcrumb([{label:"\u5185\u5BB9\u7BA1\u7406"},{label:o.name}])),q(()=>{e.loading=!1})}).catch(a=>{e.loading=!1,i.error(a.message||"\u975E\u6CD5\u64CD\u4F5C..")})},m=t=>(t.formId=e.formId,t.id=r.id,t),l=t=>{t==="success"&&c.go(-1)};return b(()=>{f()}),(t,a)=>{const o=S("ak-form"),s=j("loading");return h((v(),B("div",R,[I(o,{ref_key:"formEl",ref:n,formData:e.formData,type:k(u),dict:e.dict,requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent",beforeSubmit:m,afterSubmit:l},null,8,["formData","type","dict"])])),[[s,e.loading]])}}});export{L as default};
