import{f as O,C as R,r as d,B as y,c as C,I as M,J as N,o as S,a as c,E as G,v as J,b as u,d as W,h,j as p,u as z,w as A,e as H,L as _,m as b,G as f,M as I,n as m}from"./index.2b72f3d0.js";const Q=O({__name:"content",setup(K){const D=R(),i=d(),g=d(!0),a=y({searchData:[],tableData:[],dict:{},visible:!0,source:""}),v=C(()=>D.query.id),k=()=>{if(!v.value)return _.error("\u975E\u6CD5\u64CD\u4F5C..."),!1;const e={id:v.value};b("designById",e).then(s=>{const o=s.data;o&&Object.keys(o).length&&(a.searchData=f(o.data),a.tableData=f(o.listData),a.dict=I(o.dict),a.source=o.source,m(()=>{i.value.getListData(),g.value=!1}),E())})};M(()=>{B()});const B=N(()=>D.query.id,()=>{k()},{}),l=d(),t=y({visible:!1,title:"",formType:1,formData:{},width:"",dict:{},editId:""}),r=C(()=>{var e;return a.source&&((e=a.tableData.config)==null?void 0:e.openType)==="dialog"}),E=()=>{var e;r.value&&(t.width=(e=a.tableData.config)==null?void 0:e.dialogWidth,b("designById",{id:a.source}).then(s=>{const o=s.data;o&&Object.keys(o).length&&(t.formData=f(o.data),t.dict=I(o.dict))}).catch(s=>{_.error(s.message||"\u975E\u6CD5\u64CD\u4F5C.")}))},F=(e,s)=>{var o;(e.key==="add"||e.key==="edit")&&r.value&&(t.visible=!0,t.title=e.key==="add"?"\u65B0\u589E":"\u7F16\u8F91",t.formType=e.key==="add"?1:2,t.editId=s&&s.id,e.key==="add"&&((o=t.formData.config)==null?void 0:o.addLoad)&&m(()=>{l.value.getData({formId:a.source})}),e.key==="edit"&&m(()=>{l.value.getData({formId:a.source,id:s.id})}))},w=e=>(e.formId=a.source,e.id=t.editId,e),L=e=>{e==="success"&&(n(),i.value.getListData())},T=e=>{(e==="reset"||e==="cancel")&&n()},U=e=>{n(),e&&e()},n=()=>{t.visible=!1,t.editId=""};return S(()=>{k()}),(e,s)=>{const o=c("ak-list"),j=c("ak-form"),q=c("el-dialog"),x=G("loading");return J((u(),W("div",null,[a.visible?(u(),h(o,{key:0,ref_key:"listEl",ref:i,searchData:a.searchData,tableData:a.tableData,dict:a.dict,formId:a.source,requestUrl:"getContentList",deleteUrl:"delFormContent",autoLoad:!1,onBtnClick:F},null,8,["searchData","tableData","dict","formId"])):p("",!0),z(r)?(u(),h(q,{key:1,"destroy-on-close":"",modelValue:t.visible,"onUpdate:modelValue":s[0]||(s[0]=V=>t.visible=V),title:t.title,width:t.width||"600px","before-close":U},{default:A(()=>[H(j,{ref_key:"formEl",ref:l,formData:t.formData,dict:t.dict,type:t.formType,requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent",beforeSubmit:w,afterSubmit:L,onBtnClick:T},null,8,["formData","dict","type"])]),_:1},8,["modelValue","title","width"])):p("",!0)])),[[x,g.value]])}}});export{Q as default};
