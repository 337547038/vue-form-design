import{d as h,k,A as D,u as q,l as x,L as B,h as i,p as C,r as E,B as I,s as S,o as j,c as F,i as L,S as d,x as O,D as f,Y as R,q as T,E as m}from"./index-DLbVpaQ3.js";const M={style:{"min-height":"300px"}},w=h({__name:"form",setup(A){const g=k(),c=D(),v=q(),u=x(),e=B({formData:{list:[],form:{},config:{}},dict:{},loading:!0}),n=i(()=>c.query.id),o=i(()=>c.query.form),p=i(()=>n.value?2:1),_=()=>{if(!o.value)return d.error("非法操作."),!1;const a={id:o.value};O("designById",a).then(r=>{var s;const t=r.data;if(t&&Object.keys(t).length){const l=f(t.data);l&&Object.keys(l).length&&(e.formData=f(t.data)),e.dict=R(t.dict),(n.value||(s=e.formData.config)!=null&&s.addLoad)&&u.value.getData({formId:o.value,id:n.value}),g.changeBreadcrumb([{label:"内容管理"},{label:t.name}])}T(()=>{e.loading=!1})}).catch(r=>{e.loading=!1,d.error(r.message||"非法操作..")})},b=a=>(a.formId=o.value,a),y=a=>{a==="success"&&v.go(-1)};return C(()=>{_()}),(a,r)=>{const t=E("ak-form"),s=I("loading");return S((j(),F("div",M,[L(t,{ref_key:"formEl",ref:u,data:e.formData,type:p.value,dict:e.dict,"request-url":"getFormContent","submit-url":"saveFormContent","edit-url":"editFormContent","before-submit":b,params:{formId:o.value.value},"after-submit":y},null,8,["data","type","dict","params"])])),[[s,e.loading]])}}});typeof m=="function"&&m(w);export{w as default};
