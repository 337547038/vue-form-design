import{e as ke,z as ve,s as Ee,r as Be,l as Ce,A as ye,j as Ve,q as P,P as xe,a as c,x as we,n as A,o as d,c as p,i,m as N,F as m,b as o,w as n,f as F,g as h,p as y,d as b,t as V,_ as Ie,Y as U,L as Te,Z as Le,$ as Oe,v as H,S as Q,R as K,U as Ae,y as x,Q as J,E as w,k as Y,a0 as Ue,a1 as $e,O as Re,N as qe}from"./index.9aa6152a.js";import{_ as Ge,a as je}from"./vueFile.vue_vue_type_script_setup_true_lang.912947b2.js";const ze={class:"design-container design-table"},Me={class:"components-list"},Se=i("div",{class:"title"},"\u53EF\u9009\u5B57\u6BB5",-1),Pe={class:"content"},Ne=i("div",{class:"title"},"\u5176\u4ED6\u5B57\u6BB5",-1),He={class:"content"},Qe=i("div",{class:"title"},"\u64CD\u4F5C\u6309\u94AE",-1),Ke={class:"content"},Je={class:"title"},Ye=b("\u7F16\u8F91\u81EA\u5B9A\u4E49\u5B57\u6BB5 "),Ze={class:"main-body"},We={class:"main-form main-table"},Xe=i("p",{style:{padding:"10px 0"}},"\u63D0\u793A\uFF1A\u70B9\u51FB\u8868\u5934\u53EF\u62D6\u52A8\u6539\u53D8\u987A\u5E8F",-1),et={class:"control-btn"},tt=["innerHTML"],lt=i("i",{class:"icon-help"},null,-1),at={key:1},ot=["onClick"],nt={class:"sidebar-tools"},ut=["onClick"],st=b("\u65B0\u589ETag\u6807\u7B7E\u663E\u793A"),dt=b("\u7F16\u8F91\u4FA7\u680F\u6811\u5C5E\u6027 "),it=b("\u7F16\u8F91\u8868\u683C\u5C5E\u6027 "),rt=b("\u8BBE\u7F6E\u6570\u636E\u5B57\u5178 "),ct=b("beforeRequest "),pt=b("afterResponse "),bt=["innerHTML"],ft={key:0,id:"editJson"},_t={class:"dialog-footer"},mt=b(" \u786E\u5B9A "),Ft=ke({__name:"table",setup(ht){const Z=ve(),$=Ee(),{proxy:W}=$e(),R=Be(),v=Ce(()=>$.query.type==="table"),e=ye({direction:"rtl",filedList:[],otherFiled:[{label:"\u52FE\u9009",prop:"__selection",type:"selection"},{label:"\u5E8F\u53F7",prop:"__index",type:"index",width:"70px"},{label:"\u64CD\u4F5C",prop:"__control"}],checkboxGroup:[],controlBtn:[{label:"\u65B0\u589E",key:"add",type:"primary",size:"small",hide:v.value},{label:"\u5220\u9664",key:"del",size:"small"}],controlBtnGroup:[],tableData:{tableProps:{},columns:[],controlBtn:[]},editor:{},visibleDialog:!1,loading:!1,id:$.query.id,selectCheck:"",editIndex:"",dataList:[{}],dataTemp:{},attrObj:{},tagList:[],config:{},name:"",formId:"",dict:{},searchData:{},dialogTitle:"",treeData:{}}),X=["txt","title","table","component","upload"],I=a=>{a==null||a.list.forEach(t=>{var u;t.type==="grid"||t.type==="tabs"?t.columns.forEach(s=>{I(s)}):t.type==="card"?I(t):X.indexOf(t.type)===-1&&e.filedList.push({prop:t.name,label:(u=t.item)==null?void 0:u.label,help:t.config.help||""})})},ee=a=>{switch(a){case"del":e.tableData.columns=[],e.checkboxGroup=[];break;case"json":D(e.tableData);break;case"vue":R.value.openTable(e.tableData);break;case"save":le();break}},q=a=>{e.checkboxGroup.indexOf(a.label)===-1?e.tableData.columns.forEach((u,s)=>{u.label===a.label&&u.prop===a.prop&&e.tableData.columns.splice(s,1)}):e.tableData.columns.push(a)},D=(a,t={})=>{e.direction=t.direction||"rtl",e.visibleDialog=!0,e.dialogTitle=t.title;const u=t.type==="dict"?Q(a,!0):K(a,!0);P(()=>{e.editor=Ae(u)})},te=()=>{try{const a=x(e.editor.getValue());switch(e.editIndex){case"columns":e.tableData.columns=a;break;case"tableConfig":e.tableData.tableProps=a;break;case"dict":e.dict=J(e.editor.getValue());break;case"beforeRequest":case"afterResponse":e.tableData.events||(e.tableData.events={}),e.tableData.events[e.editIndex]=a;break;case"tree":e.tableData.tree=a;break}e.editIndex!==""?e.tableData.columns[e.editIndex]=a:e.tableData=a,e.editIndex="",e.visibleDialog=!1}catch(a){w.error(a.message)}},le=()=>{const a=e.name||e.dataTemp.name;if(!a){w.error(v.value?"\u8BF7\u8F93\u5165\u6570\u636E\u5217\u8868\u540D\u79F0":"\u8BF7\u8F93\u5165\u8868\u5355\u540D\u79F0");return}e.loading=!0;const t=Object.assign(e.dataTemp,{tableData:K(e.tableData),id:e.id,name:a,formId:e.formId||e.dataTemp.formId,type:e.dataTemp.type||2,dict:Q(e.dict)});Y("saveForm",t).then(u=>{console.log(u),w({message:u.data.message||"\u4FDD\u5B58\u6210\u529F\uFF01",type:"success"}),Z.push({path:"/designform/formlist"}),e.loading=!1}).catch(u=>{w.error(u.data.message||"\u4FDD\u5B58\u5F02\u5E38"),e.loading=!1})},ae=a=>{e.editIndex="",a()},k=a=>{switch(e.editIndex=a,a){case"dict":D(e.dict||{},{direction:"ltr",type:a});break;case"tableConfig":D(e.tableData.tableProps,{direction:"ltr"});break;case"columns":D(e.tableData.columns);break;case"beforeRequest":case"afterResponse":const t=e.tableData.events||{},u=a==="beforeRequest"?Re:qe;D(t[a]||u,{direction:"ltr"});break;case"tree":let s=e.tableData.tree||{};Object.keys(s).length===1&&(s={show:!0,name:"\u552F\u4E00\u6807\u8BC6",request:"post",sourceFun:"\u8BF7\u6C42url"}),D(s,{direction:"ltr",title:"\u66F4\u591A\u53C2\u6570\u8BE6\u89C1ak-list\u7EC4\u4EF6"});break}},oe=a=>{let t={};e.tableData.columns.forEach((u,s)=>{u.prop===a&&(t=u,e.editIndex=s)}),D(t)},ne=a=>{var s;let t=(s=e.tableData)==null?void 0:s.controlBtn,u=-1;t?t.forEach((r,E)=>{(r.key===a.key||r.label===a.label)&&(u=E)}):e.tableData.controlBtn=[],u!==-1?e.tableData.controlBtn.splice(u,1):(delete a.hide,e.tableData.controlBtn.push(a))},ue=()=>{const a=W.$el.querySelector(".el-table__header-wrapper tr");Ue.create(a,{animation:180,delay:0,onEnd:t=>{const u=e.tableData.columns[t.oldIndex];e.tableData.columns.splice(t.oldIndex,1),e.tableData.columns.splice(t.newIndex,0,u)}})},se=()=>{e.id&&Y("getFormById",{id:e.id}).then(a=>{var t,u;if(a.data.code===200){const s=a.data.data;e.dataTemp=s,I(x(s.formData)),s.tableData&&(e.tableData=x(s.tableData)),s.searchData&&(e.searchData=x(s.searchData)),v.value&&(e.name=s.name,e.formId=s.formId),e.tableData.columns.forEach(r=>{e.checkboxGroup.push(r.label)}),(t=e.tableData.controlBtn)==null||t.forEach(r=>{e.controlBtnGroup.push(r.key||r.label)}),e.treeData=((u=e.tableData)==null?void 0:u.tree)||{},e.dict=J(s.dict)}})},de=a=>{e.attrObj=a,e.config=a.config||{};const t=e.config.tagList;if(e.tagList=[],t)for(const u in t)e.tagList.push({value:u,type:t[u]})},ie=a=>{e.tagList.splice(a,1),T()},re=()=>{e.tagList.push({value:"",type:"default"})},T=()=>{const a={};e.tagList.forEach(t=>{a[t.value]=t.type}),Object.keys(a).length?e.config.tagList=a:delete e.config.tagList,L()},L=()=>{Object.assign(e.attrObj,{config:e.config})},ce=a=>{e.tableData.tree||(e.tableData.tree={}),e.tableData.tree.show=a};return Ve(()=>{P(()=>{se(),ue()})}),xe(()=>{Object.keys(e.editor).length!==0&&(e.editor.destroy(),e.editor.container.remove())}),(a,t)=>{var j,z,M,S;const u=c("el-checkbox"),s=c("el-checkbox-group"),r=c("el-button"),E=c("el-tooltip"),pe=c("el-table-column"),be=c("el-table"),_=c("el-option"),O=c("el-select"),f=c("el-form-item"),B=c("el-input"),G=c("el-tab-pane"),fe=c("el-switch"),_e=c("QuestionFilled"),me=c("el-icon"),he=c("el-tabs"),ge=c("el-form"),De=c("el-drawer"),Fe=we("loading");return A((d(),p("div",ze,[i("div",Me,[((j=e.filedList)==null?void 0:j.length)&&e.id&&!N(v)?(d(),p(m,{key:0},[Se,i("div",Pe,[o(s,{modelValue:e.checkboxGroup,"onUpdate:modelValue":t[0]||(t[0]=l=>e.checkboxGroup=l),size:"small"},{default:n(()=>[(d(!0),p(m,null,F(e.filedList,l=>(d(),h(u,{label:l.label,key:l.prop,onChange:g=>q(l)},null,8,["label","onChange"]))),128))]),_:1},8,["modelValue"])])],64)):y("",!0),Ne,i("div",He,[o(s,{modelValue:e.checkboxGroup,"onUpdate:modelValue":t[1]||(t[1]=l=>e.checkboxGroup=l),size:"small"},{default:n(()=>[(d(!0),p(m,null,F(e.otherFiled,l=>(d(),h(u,{label:l.label,key:l.prop,onChange:g=>q(l)},null,8,["label","onChange"]))),128))]),_:1},8,["modelValue"])]),Qe,i("div",Ke,[o(s,{modelValue:e.controlBtnGroup,"onUpdate:modelValue":t[2]||(t[2]=l=>e.controlBtnGroup=l),size:"small"},{default:n(()=>[(d(!0),p(m,null,F(e.controlBtn.filter(l=>!l.hide),l=>(d(),h(u,{label:l.key,key:l.prop,onChange:g=>ne(l)},{default:n(()=>[b(V(l.label),1)]),_:2},1032,["label","onChange"]))),128))]),_:1},8,["modelValue"])]),i("div",Je,[o(r,{size:"small",onClick:t[3]||(t[3]=l=>k("columns"))},{default:n(()=>[Ye]),_:1})])]),i("div",Ze,[o(Ge,{onClick:ee,type:"2"}),i("div",We,[Xe,(M=(z=e.searchData)==null?void 0:z.list)!=null&&M.length?(d(),h(Ie,{key:0,type:2,"form-data":e.searchData,dict:e.dict,requestUrl:!1},null,8,["form-data","dict"])):y("",!0),i("div",et,[(d(!0),p(m,null,F((S=e.tableData)==null?void 0:S.controlBtn,l=>(d(),h(r,U(l,{key:l.label}),{default:n(()=>[b(V(l.label),1)]),_:2},1040))),128))]),o(be,U({data:e.dataList},e.tableData.tableProps,{ref:"tableEl"}),{default:n(()=>[(d(!0),p(m,null,F(e.tableData.columns,l=>(d(),h(pe,Oe(U({key:l.prop||l.label},l)),Te({_:2},[l.help?{name:"header",fn:n(g=>[b(V(g.column.label)+" ",1),o(E,{placement:"top"},{content:n(()=>[i("span",{innerHTML:l.help},null,8,tt)]),default:n(()=>[lt]),_:2},1024)])}:void 0,l.type!=="index"?{name:"default",fn:n(()=>[l.type==="selection"?(d(),h(u,{key:0})):l.prop==="__control"?(d(),p("span",at,"\u7F16\u8F91 \u5220\u9664")):(d(),p("span",{key:2,onClick:Le(g=>de(l),["stop"])},"\u8BBE\u7F6E",8,ot))])}:void 0]),1040))),128))]),_:1},16,["data"])])]),i("div",nt,[o(ge,{size:"small"},{default:n(()=>[o(he,{modelValue:"first"},{default:n(()=>[o(G,{label:"\u5B57\u6BB5\u5C5E\u6027",name:"first"},{default:n(()=>[o(f,{label:"\u9009\u62E9\u8868\u5934\u5B57\u6BB5"},{default:n(()=>[o(O,{modelValue:e.selectCheck,"onUpdate:modelValue":t[4]||(t[4]=l=>e.selectCheck=l),onChange:oe},{default:n(()=>[(d(!0),p(m,null,F(e.tableData.columns,l=>(d(),h(_,{key:l.prop,value:l.prop,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),A(i("div",null,[i("h3",null,V(e.attrObj.label)+"\u4E2A\u6027\u5316\u8BBE\u7F6E",1),o(f,{label:"\u65F6\u95F4\u683C\u5F0F\u5316"},{default:n(()=>[o(O,{modelValue:e.config.formatter,"onUpdate:modelValue":t[5]||(t[5]=l=>e.config.formatter=l),onChange:L},{default:n(()=>[o(_,{label:"{y}-{m}-{d} {h}:{i}:{s}",value:"{y}-{m}-{d} {h}:{i}:{s}"}),o(_,{label:"{y}-{m}-{d}",value:"{y}-{m}-{d}"}),o(_,{label:"{h}:{i}:{s}",value:"{h}:{i}:{s}"})]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"\u503C\u5339\u914D\u5B57\u5178"},{default:n(()=>[o(B,{placeholder:"\u5B57\u5178\u5BF9\u5E94\u7684key",modelValue:e.config.dictKey,"onUpdate:modelValue":t[6]||(t[6]=l=>e.config.dictKey=l),onChange:L},null,8,["modelValue"])]),_:1}),(d(!0),p(m,null,F(e.tagList,(l,g)=>(d(),h(f,{key:g,class:"table-tag"},{default:n(()=>[o(B,{placeholder:"\u503C\u5BF9\u5E94\u7684\u7C7B\u578B",modelValue:l.value,"onUpdate:modelValue":C=>l.value=C,onChange:T},{append:n(()=>[o(O,{style:{width:"80px"},modelValue:l.type,"onUpdate:modelValue":C=>l.type=C,onChange:T},{default:n(()=>[o(_,{label:"default",value:"default"}),o(_,{label:"success",value:"success"}),o(_,{label:"info",value:"info"}),o(_,{label:"warning",value:"warning"}),o(_,{label:"danger",value:"danger"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"]),i("i",{class:"icon-del",onClick:C=>ie(g)},null,8,ut)]),_:2},1024))),128)),o(f,null,{default:n(()=>[o(r,{onClick:re},{default:n(()=>[st]),_:1})]),_:1})],512),[[H,Object.keys(e.attrObj).length]])]),_:1}),o(G,{label:"\u6570\u636E\u5217\u8868\u914D\u7F6E",name:"second"},{default:n(()=>[N(v)?(d(),p(m,{key:0},[o(f,{label:"\u6570\u636E\u5217\u8868\u540D\u79F0"},{default:n(()=>[o(B,{modelValue:e.name,"onUpdate:modelValue":t[7]||(t[7]=l=>e.name=l),placeholder:"\u8BF7\u8F93\u5165\u6570\u636E\u5217\u8868\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(f,{label:"\u6570\u636E\u6E90Id"},{default:n(()=>[o(B,{modelValue:e.formId,"onUpdate:modelValue":t[8]||(t[8]=l=>e.formId=l),placeholder:"\u8BF7\u8F93\u5165\u6570\u636E\u6E90Id"},null,8,["modelValue"])]),_:1})],64)):y("",!0),o(f,{label:"\u5F00\u542F\u4FA7\u680F\u6811"},{default:n(()=>[o(fe,{modelValue:e.treeData.show,"onUpdate:modelValue":t[9]||(t[9]=l=>e.treeData.show=l),onChange:ce},null,8,["modelValue"])]),_:1}),A(o(f,null,{default:n(()=>[o(r,{onClick:t[10]||(t[10]=l=>k("tree"))},{default:n(()=>[dt]),_:1})]),_:1},512),[[H,e.treeData.show]]),o(f,{class:"event-btn"},{default:n(()=>[o(r,{onClick:t[11]||(t[11]=l=>k("tableConfig"))},{default:n(()=>[it]),_:1}),o(r,{onClick:t[12]||(t[12]=l=>k("dict"))},{default:n(()=>[rt,o(E,{content:"\u6570\u636E\u5B57\u5178\uFF0C\u7528\u4E8E\u5339\u914D\u591A\u9009\u7EC4\u3001\u4E0B\u62C9\u9009\u62E9\u7B49\uFF0C\u63D0\u4F9B\u52A8\u6001\u83B7\u53D6Options\u63A5\u53E3\u5B57\u5178\u6570\u636E\uFF0C\u4E00\u822C\u4E0D\u8BBE\u7F6E\uFF0C\u4ECE\u63A5\u53E3dict\u83B7\u53D6\u3002\u683C\u5F0F\uFF1A{0:'\u7537',1:'\u5973'}",placement:"top"},{default:n(()=>[o(me,null,{default:n(()=>[o(_e)]),_:1})]),_:1})]),_:1}),o(r,{onClick:t[13]||(t[13]=l=>k("beforeRequest"))},{default:n(()=>[ct]),_:1}),o(r,{onClick:t[14]||(t[14]=l=>k("afterResponse"))},{default:n(()=>[pt]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),o(De,{modelValue:e.visibleDialog,"onUpdate:modelValue":t[15]||(t[15]=l=>e.visibleDialog=l),size:"60%",direction:e.direction,"custom-class":"ace-dialog","append-to-body":!0,"before-close":ae},{header:n(()=>[i("div",{innerHTML:e.dialogTitle},null,8,bt)]),default:n(()=>[e.visibleDialog?(d(),p("div",ft)):y("",!0),i("div",_t,[o(r,{type:"primary",size:"small",onClick:te},{default:n(()=>[mt]),_:1})])]),_:1},8,["modelValue","direction"]),o(je,{ref_key:"vueFileEl",ref:R},null,512)])),[[Fe,e.loading]])}}});export{Ft as default};
