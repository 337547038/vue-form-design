import{d as g,u as _,G as D,i as p,B as y,m as C,j as h,s as v,o as b,c as B,g as I,q as k,M as i,k as E,N as F,O as j,h as q,Z as S,y as x}from"./index.4bea5897.js";const M={style:{"min-height":"300px"}},U=g({__name:"form",setup(O){const d=_(),r=D().query,c=x(),n=p(),e=y({formData:{list:[],form:{},config:{}},dict:{},formId:r.form,id:r.id,loading:!0}),u=C(()=>r.id?2:1),f=()=>{if(!e.formId)return i.error("\u975E\u6CD5\u64CD\u4F5C."),!1;const t={id:e.formId};E("designById",t).then(a=>{var s;const o=a.data;o&&Object.keys(o).length&&(e.formData=F(o.data),e.dict=j(o.dict),(r.id||((s=e.formData.config)==null?void 0:s.addLoad))&&n.value.getData({formId:e.formId,id:r.id}),d.changeBreadcrumb([{label:"\u5185\u5BB9\u7BA1\u7406"},{label:o.name}])),e.loading=!1}).catch(a=>{e.loading=!1,i.error(a.message||"\u975E\u6CD5\u64CD\u4F5C..")})},m=t=>(t.formId=e.formId,t.id=r.id,t),l=t=>{t==="success"&&c.go(-1)};return h(()=>{f()}),(t,a)=>{const o=q("ak-form"),s=S("loading");return v((b(),B("div",M,[I(o,{ref_key:"formEl",ref:n,formData:e.formData,type:k(u),dict:e.dict,requestUrl:"getFormContent",addUrl:"saveFormContent",editUrl:"editFormContent",beforeSubmit:m,afterSubmit:l},null,8,["formData","type","dict"])])),[[s,e.loading]])}}});export{U as default};
