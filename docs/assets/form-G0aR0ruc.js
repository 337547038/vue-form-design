import{d as D,k,l as q,G as U,h as s,y as C,p as I,s as j,W as B,c as E,j as F,N as f,A as x,X as m,r as O,u as R,o as M,z as d}from"./index-CbbnYBXf.js";const N={style:{"min-height":"300px"}},S=D({__name:"form",setup(T){const g=k(),l=C(),v=R(),i=q(),r=U({formData:{list:[],form:{},config:{}},dict:{},loading:!0}),u=s(()=>l.query.id),o=s(()=>l.query.form),c=s(()=>u.value?"edit":"add"),p=s(()=>{const{submitUrl:e}=r.formData.config;return e||(c.value==="add"?"saveFormContent":"editFormContent")}),_=s(()=>{const{requestUrl:e}=r.formData.config;return e||"getFormContent"}),b=()=>{if(!o.value)return f.error("非法操作."),!1;const e={id:o.value};x("designById",e).then(a=>{const t=a.data;if(t&&Object.keys(t).length){const n=m(t.data);n&&Object.keys(n).length&&(r.formData=m(t.data)),u.value&&i.value.getData({formId:o.value,id:u.value}),g.changeBreadcrumb([{label:"内容管理"},{label:t.name}])}r.loading=!1}).catch(a=>{r.loading=!1,f.error(a.message||"非法操作..")})},y=e=>(e.formId=o.value,e),h=(e,a,t)=>{a&&t==="submit"&&v.go(-1)};return I(()=>{b()}),(e,a)=>{const t=O("ak-form"),n=B("loading");return j((M(),E("div",N,[F(t,{ref_key:"formEl",ref:i,data:r.formData,"operate-type":c.value,"request-url":_.value,"submit-url":p.value,before:y,params:{formId:o.value.value},after:h},null,8,["data","operate-type","request-url","submit-url","params"])])),[[n,r.loading]])}}});typeof d=="function"&&d(S);export{S as default};
